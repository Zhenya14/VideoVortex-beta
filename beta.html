<!DOCTYPE html>
<html lang="uk">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VideoVortex</title>
<meta name="description" content="VideoVortex ‚Äî –Ω–µ–∑–∞–ª–µ–∂–Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –≤—ñ–¥–µ–æ –±–µ–∑ —Ü–µ–Ω–∑—É—Ä–∏. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ YouTube.">
<meta name="keywords" content="–≤—ñ–¥–µ–æ—Ö–æ—Å—Ç–∏–Ω–≥, –≤—ñ–¥–µ–æ –æ–Ω–ª–∞–π–Ω, –≤—ñ–¥–µ–æ—Å–µ—Ä–≤—ñ—Å, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ youtube, VideoVortex">
    <link rel="icon" href="VideoVortex_logo.ico">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-storage.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-functions.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-messaging.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script type="module">
  import { createFFmpeg, fetchFile } from "https://unpkg.com/@ffmpeg/ffmpeg@0.12.6/dist/ffmpeg.min.mjs";

  window.ffmpeg = createFFmpeg({
    log: true,
    corePath: "https://unpkg.com/@ffmpeg/core@0.12.6/dist/ffmpeg-core.js"
  });

  window.fetchFile = fetchFile;
</script>
        <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-JQTQ0P69EF"></script>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1c1e22">
<link rel="apple-touch-icon" href="icons/icon-192.png">

<script defer>
  if ("serviceWorker" in navigator) {
    navigator.serviceWorker.register("service-worker.js")
      .then(() => console.log("‚úÖ SW –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ"))
      .catch(err => console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ SW:", err));
  }
</script>
        <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JQTQ0P69EF');
</script>
<!-- SVG Filter (–¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ä—ñ–¥–∫–æ–≥–æ —Å–∫–ª–∞) -->
<!-- SVG Filter (–¥–ª—è –∞–Ω—ñ–º–∞—Ü—ñ—ó —Ä—ñ–¥–∫–æ–≥–æ —Å–∫–ª–∞) -->
<svg style="display: none">
    <filter id="displacementFilter">
        <feImage
                href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAMoElEQVRogZ1a3ZqjyI6MkBJc3XOz7/+g+53pMoq9kJQk2K6Zs0yNGzAG/YRCSgn+/r0PYpCD2IEH+SC/yIdZfj6MD9pu3M02cjMb5KC50cycNBoJ0kiCJKn8BEWCACgCAkAAIAhQAGAAIRccNGIDBjCADdilHdilh/QAH9AX+DA+yN1sM9vAYRw2SIKg1dNJkm61Y0YzGkmDGc1A0og8JEGT1Q1gBCkQJEgArENgCi4QFDR1AABIAEEJggAIECRJogBJeblIkLK0AUEOjpQUBMzMyPk/naTRUvTUgTQDjWZESmxgfgJGIA8poE62+HNHvSeJedzngdYgZZaASNepr1HelgQhYthuhjKrpaBmrP+MZuUHt9IqP9mKWnkEZiAxzc8UkgQFkDzFLAeohZJw7qh3InRAIYYUQAhBCOVStauHbaTBQXMaPWV2L4Sb08ytxPUS1wxmaftohIEX0QkT076Fe1UcZExISB3Uhp3Ctw9CSt0i2jMSKCKmP4nBB70AYsbEudtwcx++DR/DbJi7mafh6WVs2sSPQJql+Zmxm9Y/kVPSsw1OlB/K3gIhEwI4ICqDO47QM8Lj2BShCFHMCEnTaPhXYd5TBXN3H2N/7PtjezzG/nDfzDe6kw66+cRQBsQKfaSLK2RXBU6Y84SSFtwrhCOjNcULAaEIHId/f38f37tCoQAEBCBQ0uCXO+E0N7rb5j58e+y/f339/v3462t7bDaGuTMZkwZ6RgBIEvk50d/Si1DGMi8KqHVicc8ZstEIknBAh3Aojjjw/Obzb/v7z/78ez9CVAhKiAHDv8qYLPSPfX/8+vX719f//Nr/2rd9s+FWdOPNWCk9KzpZzM7Cjdr2J0+CnPSji+yEAATAPqeCO0IRccTzie9tH//7/A+ex98hISoeAhr2SCah08wSPV/7778eX3899t/DNrdJnMVXGapW4hbceSLnZP4VP9P20jw76afUUAMqACkkQYPb+OP8j8WXjnhGxHFECBQEcPCr2JFGp49tG4992x/742GeadcIFNXgBE3zQJ1sE99wX0Q/sbXkrsvRCa+ZCxonh/jc9Y3vZ4yDT4UiEJLIkIZ9mYFmNtLGw20bY9vMh/mocAVViM/Yb7uDInlyJRfEL9C/RO881HJGEFtZQJnBLc8LDBwxxrF7wCNiZmmBw3abGcvo5u6bcTg9MzEh4sXkrUMVBLwY/oV83m7pNgEpO1sNZDSUtWAZL6ag3GKjghIVRabDdzeaZx6AmRs35yCsLTq5pUHPhW1O/LwXnauVr1t7RQuvcuYHAKpUSIYgMzkhyiAwQkWjtruDltUlRuZf+qx/WCiZ9cdCO9OQn23fmp940eUrCMwgpgArNVQRiqo5YJBn8UGJQEAsCPnmDnoXOk7H8CQm2Mru09LzD1cs/ajAaXV79cUstZupqoA6CcsIIZyiEIiqMxJCw410ZJ5y0tyJTrbT0h20L9J/9MNVE85/rrFbUs4I4HpeVXJKAVlWIQxrjpJEDPOytlkyvaOL0AUti7icKt00WSR+5SKhi5eVTtdMrdUH0kJveRElL29nJi4P2Kh1SqcqTvzwLmsF9Sn0xwC4UdDbzHaTm7WqqeDOmpuiQCIaRVVr5dIHQHmgFlqmWqmwFll5La/QZ+P61Q/9mUkNpzxX2c8lzZReaJOvsdCHygVAUAYJwUxzDGDQ5wLRDEZ5umHlnKvtL5iZCe6uxksk36XXTb1Xn+R9VKkzuSgoEmZSZOk0LFcyuSYrD3T4LtIvbHMR9L0H3oTvi+3Lf1otnd92NPfCIRc7hGSy6hXUugwYtQyWmVmulgm78D1XWW5S/iD9HezvtlfpZ3CXDmWlJCMjZAELSvAswIeZTfxkAjtDtrI9X2RdDf9WsZv9Lwb+IDcnVXE9vER/rvVy0Vc5wgzu8FMHeHqA5++4yLJq8rMTbpd90vPyqeVQ19/OsiI/xVozDaMbaLLsmWR3oYJmeeQ1Kv9RxJsf5vaD7W/kc95B/XlKn9eQgHJ9PkU3g6E8cIoyeeaKnFWTH3b+q1D5IXJOL6kWxBRg7GZVU03uGLhQp2636SB58+BXV9xUvetzWyq8/Xk7YWny9WaE5anknyyrVgy+M+fbJ93M/Oknr9sPqHvxku7ONCBbUGwdzr+K/PePfCv6W7F+UO9ywZuc9vLzeU35ROgYmDpk1/WN+f/l9paLflCPL6fOMwu6lLUbs4brOABglKXQldl62f7JBv8k+n+98ePRHauq/kXvIxWoFmGmYauerz5J/BoDc9PLlf8k7Rs/XPsU77cmeBGAUYQKQiV9k8+rT3/cbpe9fbxeD/Xm/PvnMoXXSYwUzJr1iTlamYy7pvJ/3N4uFOff/2Ob04OWWK8eaw6d31GmPqTeWv+tl+/08Gnh+7r/zxZqSjmlLLUEcXRqarqYJe3lQe+f8qKgfoyKtzp8MsFlu4ZdO0UkZZgeOlsCuCpx2X138hXZPwfAv0fUTKtYhWq6zPCtb7he11HwD0Lw5cz1UJ8NfH7qZyeUDDUUnAzTa1blWOUknHzmOVJ70eEDRG5i3aDy0fYXTjnFAq5wB9AzsbZtMiY1ijKN6hblyaB97+Ve1XA6EyT4Y0n8ul2Uud58VeyycyV1nRASLBXJYpt2XQW8mutFgs+k9IlVbzv3Gy6EeOqmU/pe8mbdbBhFpPOurGKjdU87lYG7WwNBOX2vFSBnUEwP4IMTrvpXE1TvKPvs5FNIwukUm01zGDBy7Jfd1e43anJv31arC+uwwr+/Onmre5pamw7vdVjgevfJ+txqRVmPPxMvIsAhx5nS1U3hALITebFKD0bvlsbd8BcS+yj9y7darFAgWNfm2U8x5mqrwD7gU/wUUTUwj1sqTqtnHJ9d2G4itL2n7d6IfhX0JLv3V5Zz2HFnVXUmU3bvhINeaqdzJPEQONvgN0yfcXU+pn/auJrS/FjecbJQBcPCp7XPs0gQTTVZN/asUSQGvSdb1TVtrUO3x7bNl4nQyaq44Gr96RrPd1C9wImn9OdTa34LmuiiJ51EQYhb1qHdwIq2ztoau2eAoiau2p3Mpbvpb85YvMSrDpwj5v66gQQ6MECHeQ6ZSMCoga3SQiKfQQAIQmd1NAclyoyIOdW9RsgFJG9TyXLBawDwclkzppj8YzIXh+DZfcjFlw2NnJaVDnFAgELIt0Im68xIPcXFkk3/fQSvoresN33WZk5lAdDB0X+A2cwDe1JP5i/CJECHEksFHS3PzmUGm4h068JqccZE1HL+1SFr3F/VKD8Q5qmAbAcd3UAXwIGHEMzkq5CegqQnFKpUgJo9vFD/VeiLGlex1mi+A+ZF9NlcQOEaBpg4xB3cZCNbo6kDB/bm5chJpwKBI6QIhcmkGvEscvfsKSPijt77diEprqGPnsqAKFqsHEhgzvgsfMi2sE22ywaybCNAw+DeHkvMuALHoe8Dw2k6OqwZC7+tcQzcC5nGUI3dsfiIa52FHmrPYE2TlAsV2bEaI3w8t8cxHoc/wAFI9Gq0D37RauhBShrS0GHHk9/m8OdQ0MFDsE4UBEw43wZIyS4R/NEPtd+/5Aqk2VojDNnmj0GN7bnvf/Zff7avw7fDh5w01GuSg49eKgQA46E4jm//5gb+ifh+ejBkFhXQJhgQoqWZZqu76sEzF826SZp+KKyzxZ3Qz4ZUNacgJ5wYjM31tT9/7X++Ht/b4+kuOskga4w3+EVEY0OKgAmxP78fwvMYTzuCLrhgwXrzol8ctO71sVj4bMovpYYWQBHz336jlN0ezL6aQ8MwKCc2xu56+PPXFvv2HEOVELrhT8PQXgFTr6+IEXHsxHEwQgc8KEABE0aVLTAxXxJL+J3NvJM/EiWFk7N866ivV0t7oIKckEKDGIQzdtcG7B4P0/AYLmOQSPTnRIPkwKOKgswDqnqUETpCQL2JR5ChrFBTn9RWUivASvqauGoU9QtAlRNmbZPrlLJ9v5QLGTEMngHgcmKYzETO+VdOISlhxKNeAGE6PtOWInkpJ+IUQjLNfKekpXRFLbVbh8XOXX0vyOl1d2eMjKosgZofsnYAROtpmFULEcsMGDASQ3t6WpbLmJyCZySklFAIEcpXOxkpgBigGIBJyPqql4d5p+aXtUaizhfCiX7Pes7UaSJIE7C8nFrXdAPU5uyCAIe2IoyADMwJeOK7DV+LnNyvMjtfyy78GM7XPc/grXeje2mFfqdO6CbURRLAquggOeXukJ2pF0V4pwIjpotzdFw4yUIi+iXIwo9KpWg+73FDgUL9YnSTEdfVLuv1MhE2XyrlJCXjgiLU6AXovAsqybPKAlHA/wH75uVy+EFM3wAAAABJRU5ErkJggg=="
                preserveAspectRatio="none"/>

        <feDisplacementMap
                in="SourceGraphic"
                in2="turbulence"
                scale="300"
                xChannelSelector="R"
                yChannelSelector="G"
        />
    </filter>
</svg>
<style>
    .bg-liquid-glass {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 600px;
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 0px 0px;
  border-radius: 56px;
  background: rgba(255, 255, 255, 0.1);
  /* –¢—ñ–Ω—å —ñ –æ–±–≤–µ–¥–µ–Ω–Ω—è –¥–ª—è –≥–ª–∏–±–∏–Ω–∏ */
  z-index: 1000;
  isolation: isolate;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        @apply bg-muted/25;
    }
    .tg-popup {
  position: fixed;
  inset: 0;
  display: inline;
  z-index: 9999;
}

.tg-popup.hidden {
  display: none;
}

.tg-popup-card {
  width: 90%;
  padding: 20px;
  border-radius: 20px;
  background: rgba(255,255,255,.12);
isolation: isolate;
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
  box-shadow: 0 15px 40px rgba(0,0,0,.4);
  color: white;
  text-align: center;
  position: relative;
  animation: popupIn .35s ease;

  /* –¥–æ–¥–∞–Ω–æ –¥–ª—è –≤–∏—Ä—ñ–≤–Ω—é–≤–∞–Ω–Ω—è –≤ —Ä—è–¥ */
  display: flex;
  flex-direction: row; /* —Ä—è–¥–æ–∫ */
  justify-content: center; /* –ø–æ —Ü–µ–Ω—Ç—Ä—É –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ */
  align-items: center; /* –ø–æ —Ü–µ–Ω—Ç—Ä—É –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
  gap: 10px; /* –≤—ñ–¥—Å—Ç–∞–Ω—å –º—ñ–∂ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏ */
}

@keyframes popupIn {
  from { transform: scale(.85); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}

.tg-close {
  position: absolute;
  top: 2px;
  right: 4px;
  background: none;
  border: none;
  font-size: 20px;
  color: white;
  cursor: pointer;
}

.tg-join-btn {
  display: block;
  margin-top: 15px;
  padding: 12px;
  border-radius: 14px;
  background: linear-gradient(135deg,#0088cc,#00bfff);
  color: white;
  text-decoration: none;
  font-weight: bold;
}
    .comment-liquid-glass {
width: 80%;  /* –®–∏—Ä–∏–Ω–∞ –ø–æ–ª—è –≤–≤–æ–¥—É */
    padding: 10px;
    margin-right: 10px;  /* –í—ñ–¥—Å—Ç—É–ø –º—ñ–∂ –ø–æ–ª–µ–º –≤–≤–æ–¥—É —Ç–∞ –∫–Ω–æ–ø–∫–æ—é */
    border: 1px solid #c9c9c9;
    border-radius: 5px;
    color: #333;
    background: rgba(255, 255, 255, 0.1);
    box-sizing: border-box;
      isolation: isolate;
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        @apply bg-muted/25;
    }
    .button-liquid-glass {
      display: grid;
    transition: 0.3s;
    width: 30%;
    height: 100%;
    justify-content: space-around;
    margin: 0px 0px 0px 0px;
    border-radius: 56px;
    text-decoration: none;
      background: rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(2px);
  -webkit-backdrop-filter: blur(2px);
  filter: url(#glass-distortion);
  -webkit-filter: url(#glass-distortion);

  /* –¢—ñ–Ω—å —ñ –æ–±–≤–µ–¥–µ–Ω–Ω—è –¥–ª—è –≥–ª–∏–±–∏–Ω–∏ */
  box-shadow: 0 8px 32px rgba(31, 38, 135, 0.37);
  border: 1px solid rgba(255, 255, 255, 0.18);

  z-index: 100;
    }

    @supports not (hanging-punctuation:first) {
        .bg-liquid-glass, .comment-liquid-glass, .tg-popup-card {
            backdrop-filter: url(#displacementFilter) blur(2px);
        }
    }
</style>
        <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-JQTQ0P69EF');
</script>
<style>
#photo-file, #video-file {
  display: none;
}
/* –°—Ç–∏–ª—å –ø–æ–≤–∑—É–Ω–∫–∞ */
.switch {
  position: relative;
  display: inline-block;
  width: 50px;
  height: 26px;
}

.switch input { 
  opacity: 0;
  width: 0;
  height: 0;
}

.slider {
  position: absolute;
  cursor: pointer;
  background-color: red;
  border-radius: 34px;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  transition: 0.4s;
}

.slider:before {
  position: absolute;
  content: "";
  height: 20px;
  width: 20px;
  left: 3px;
  bottom: 3px;
  background-color: white;
  border-radius: 50%;
  transition: 0.4s;
}

input:checked + .slider {
  background-color: orange;
}

input:checked + .slider:before {
  transform: translateX(24px);
}

/* –ö—Ä—É–≥–ª—ñ –∫—Ä–∞—ó */
.slider.round {
  border-radius: 34px;
}

.slider.round:before {
  border-radius: 50%;
}
.btn-container {
    display: flex;
    flex-basis: auto;
    justify-content: center;
    flex-direction: row;
    flex-grow: 1;
    align-items: center;
    overflow: hidden;
    height: 100%;
    width: 100%;
}
.downloads-list {
    font-size: 30px;
    list-style: none;
    text-decoration: none;
    padding: 0;
    width: 100%;
    max-width: 350px;
    margin-top: -3px;
}
.ios-modal {
  display: none;
  position: fixed;
  z-index: 9999;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px);
  justify-content: center;
  align-items: center;
  animation: fadeIn 0.3s ease;
}
.ny-popup {
  position: fixed;
  inset: 0;
  backdrop-filter: blur(20px);
  background: rgba(0,0,0,0.6);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.ny-content {
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  color: white;
  padding: 30px;
  border-radius: 20px;
  text-align: center;
  max-width: 320px;
  box-shadow: 0 0 40px rgba(255,255,255,0.3);
  animation: pop 0.4s ease;
}

.ny-content h2 {
  margin-bottom: 15px;
}

.ny-content button {
  margin-top: 20px;
  padding: 10px 20px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  background: #fff;
  color: #00344f;
  font-weight: bold;
}

@keyframes pop {
  from {
    transform: scale(0.7);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}
.ios-modal-content {
  width: 90%;
max-width: 420px;
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(25px);
  border-radius: 20px;
  color: #fff;
  text-align: center;
  box-shadow: 0 0 30px rgba(0, 0, 0, 0.4);
  animation: popIn 0.4s ease;
  border: 1px solid rgba(255, 255, 255, 0.25);
}

.ios-modal-content h2 {
  font-weight: 600;
  font-size: 20px;
  margin-bottom: 10px;
}

.ios-modal-content ul {
  text-align: left;
  margin: 10px 0 20px 25px;
  font-size: 15px;
  line-height: 1.4em;
}

.modal-divider {
  width: 100%;
  height: 1px;
  background: rgba(255, 255, 255, 0.25);
}

.ios-modal-content button {
  background: transparent;
  color: #007aff;
  border: none;
padding: 14px;
  border-radius: 0 0 20px 20px;
margin: 0;
  font-size: 17px;
  font-weight: 600;
  width: 100%;
  height: 100%;
  cursor: pointer;
  transition: background 0.3s;
}
/* üéÑ –ù–∞ –ù–æ–≤–∏–π —Ä—ñ–∫ —Ö–æ–≤–∞—î–º–æ –≤—Å—ñ Material s */
/* –ù–æ–≤–æ—Ä—ñ—á–Ω—ñ —Å—Ç–∏–ª—ñ */
body.newyear {
  background: radial-gradient(circle at top left, #071233, #031028);
  color: #f8fafc;
  transition: background .6s ease;
}
.logo-newyear {
  filter: drop-shadow(0 6px 20px rgba(255,220,120,0.12)) hue-rotate(10deg);
  transform-origin: center;
  animation: jingle 5s ease-in-out infinite;
}
@keyframes jingle {
  0% { transform: rotate(-2deg); }
  50% { transform: rotate(2deg); }
  100% { transform: rotate(-2deg); }
}
/* —Å—Ç–∏–ª—å –¥–ª—è —Å–Ω—ñ–∂–∏–Ω–∫–∏ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –µ–ª–µ–º–µ–Ω—Ç .snowflake) */
.snowflake {
  position: fixed;
  top: -10px;
  color: white;
  font-size: 16px;
  animation: fall linear infinite;
  pointer-events: none;
  z-index: 99999;
  text-shadow: 0 2px 6px rgba(0,0,0,0.4);
}
@keyframes fall {
  0% { transform: translateY(-10vh) translateX(0); opacity: 1; }
  100% { transform: translateY(110vh) translateX(30vw); opacity: 0; }
}
.ios-modal-content button:hover {
  background: rgba(255, 255, 255, 0.1);
}

.ios-modal-content button:active {
  background: rgba(255, 255, 255, 0.2);
}

@keyframes popIn {
  from { transform: scale(0.8); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
        img {
    padding: 0px 0px 0px 0px;
    height: 50px;
    width: 50px;
    border-radius: 80px;
        }
        body { 
    color: #e9ecf1;
  font-family: Inter, Segoe UI, Roboto, Arial;
  margin: 0;
  background: radial-gradient(ellipse at top, #0b0f17, #05060a);
    line-height: 1.6;
text-align: center;
    padding: 0 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
}
        }
        .video-status {
  margin: 6px 0;
  font-size: 12px;
  opacity: 0.85;
}
        .container {
    margin-top: 130px;
    width: 70%;
    background: rgba(0, 0, 0, 0.7);
    border-radius: 10px;
    box-shadow: 0 4px 12px rgb(0 0 0 / 30%);
    max-width: 1200px;
  margin: 0 auto;
  padding: 16px;
    margin-bottom: 10px;
}
        } 
        .snowflake {
    position: fixed;
    top: -10px;
    color: #fff;
    font-size: 1em;
    animation: fall linear infinite;
    pointer-events: none;
    z-index: 1000;
}
::-webkit-scrollbar {
width: 10px;
background-color: #f1f1f1;
}
::-webkit-scrollbar-thumb {
background-color: #888;
border-radius: 5px;
}
::-webkit-scrollbar-thumb:hover {
background-color: #555;
}
::-webkit-scrollbar {
height: 10px;
}
@keyframes fall {
    0% {
        transform: translateX(0) translateY(0);
        opacity: 1;
    }
    100% {
        transform: translateX(calc(-50vw + 100vw * var(--x))) translateY(100vh);
        opacity: 0;
    }
}
        .form, .auth-form, .register-form, .edit-form, .version-form { 
            display: none; 
            background: rgba(255, 255, 255, 0.1); 
            padding: 20px; 
            border-radius: 10px; 
            margin-top: 130px;
        }
        input[type="text"], input[type="file"], input[type="email"], input[type="password"], #video-description, #photo-description { 
            width: 100%; 
            background-color: black;
            color: white;
            padding: 10px 0; 
            margin: 10px 0; 
            border-radius: 35px; 
            border: none; 
            outline: none;
            font-size: 1em;
        }
.more-btn {
position: absolute;
    right: 20px;
}
.random-comments, #button-name, #button-supername, #save-name, #save-supername, .save {
width: 100%; 
            background-color: black;
border: 2px solid #333333;
            padding: 10px 0; 
            margin: 10px 0; 
            border-radius: 35px; 
            border: none; 
            outline: none;
            font-size: 1em;
}
        button { 
  display: inline-block;
  padding: 12px 28px;
  border-radius: 999px;
  text-align: center;
  text-decoration: none;
  color: white;

  background: #0b0b0b;
  border: 2px solid #2a2a2a;

  cursor: pointer;

  transition:
    box-shadow .25s ease,
    transform .2s ease,
    border-color .25s ease,
    background .25s ease,
    color .25s ease;

  box-shadow: 0 0 0 rgba(244, 114, 182, 0);
}

/* üîÆ –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
button:hover { 
  border-color: #f472b6;
  box-shadow: 0 0 18px rgba(244, 114, 182, .65);
  transform: translateY(-2px);
}

/* ‚ùáÔ∏è –ø—Ä–∏ –∫–ª—ñ–∫—É */
button:active {
  border-color: #06b6d4;
  box-shadow: 0 0 12px rgba(6, 182, 212, .75);
  transform: scale(0.96);
}

/* üö´ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞ –∫–Ω–æ–ø–∫–∞ */
button:disabled {
  opacity: .45;
  cursor: not-allowed;
  box-shadow: none;
  transform: none;
}
.photo-label { 
            display: inline-block;
    padding: 12px 28px;
    border-radius: 50px;
    text-align: center;
    text-decoration: none;
    color: white;
    background: #111111;
    border: 2px solid #333333;
    transition: all 0.3s ease;
    box-shadow: 0 0 0 rgb(59 130 246 / 0%);
        }
        .photo-label:hover { 
            border-color: #f472b6; /* –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ –±–ª–∞–∫–∏—Ç–Ω–∏–º */

box-shadow: 0 0 15px #f472b6; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è */

transform: translateY(-2px); /* –ª–µ–≥–∫–µ –ø—ñ–¥–Ω—è—Ç—Ç—è */
        }
.photo-label:active {
border-color: #06b6d4; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px #06b6d4; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
.video-label { 
            display: inline-block;
    padding: 12px 28px;
    border-radius: 50px;
    text-align: center;
    text-decoration: none;
    color: white;
    background: #111111;
    border: 2px solid #333333;
    transition: all 0.3s ease;
    box-shadow: 0 0 0 rgb(59 130 246 / 0%);
        }
        .video-label:hover { 
            border-color: #f472b6; /* –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ –±–ª–∞–∫–∏—Ç–Ω–∏–º */

box-shadow: 0 0 15px #f472b6; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è */

transform: translateY(-2px); /* –ª–µ–≥–∫–µ –ø—ñ–¥–Ω—è—Ç—Ç—è */
        }
.video-label:active {
border-color: #06b6d4; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px #06b6d4; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
       .video-container {
  background: rgba(8, 12, 20, 0.9);
  border-radius: 18px;
  padding: 12px;
  border: 1px solid rgba(0, 255, 255, .12);
  box-shadow: 0 0 22px rgba(0, 255, 255, .07);
  transition: transform .2s ease, box-shadow .25s ease;
  display: flex;
  flex-direction: column-reverse;
  position: relative;
  z-index: 1;
}

.video-container:hover {
  transform: translateY(-4px);
  box-shadow: 0 0 26px rgba(0, 255, 255, .18);
}

video,
audio {
  border-radius: 14px;
  width: 100%;
}
        .video-info { 
            text-align: left; 
            color: #b0bec5; 
            padding: 5px;
            display: flex;
        }
.video-comment {
    border-radius: 20px;
    margin-left: 0.5px;
    overflow-y: auto;        /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Å–∫—Ä–æ–ª */
    max-height: 100%;        /* –ø–æ–≤–Ω–∞ –≤–∏—Å–æ—Ç–∞ */
    padding-right: 10px; 
    background-color: #2a2727;
}
#video-container {
margin-top: 50px;
width: 90%;
        }
        .photo-container {
    margin-top: 50px;
    flex-direction: column-reverse;
        }
        /* –°—Ç–∏–ª—ñ –¥–ª—è –∑–æ–±—Ä–∞–∂–µ–Ω—å –∑ –∫–ª–∞—Å–æ–º .photo-item */
img.photo-item {
    width: 100%;  /* –ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–ø–æ–≤–Ω—é—î —à–∏—Ä–∏–Ω—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    height: auto; /* –ü—Ä–æ–ø–æ—Ä—Ü—ñ—ó –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è */
    object-fit: cover; /* –û–±—Ä—ñ–∑–∞—î –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–ª—è –∑–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
    border-radius: 8px; /* –û–∫—Ä—É–≥–ª–µ–Ω–Ω—è –∫—É—Ç—ñ–≤ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è */
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* –¢—ñ–Ω—å –¥–ª—è –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è */
    }
    .comment-section {
    position: sticky;
    top: 0;
    z-index: 10;
    display: block;
    align-items: center;
    gap: 8px;
    padding: 10px;
    border-radius: 16px;
}
.comment-input {
    background: transparent;
    position: absolute;
    bottom: 220px;
    border: none;
    outline: none;
    color: white;
    font-size: 14px;
    padding: 8px 12px;
}
.video-details {
    white-space: normal !important;
    word-wrap: break-word !important;
    overflow-wrap: break-word !important;
}
.comment-button {
    width: 50px;
    height: 40px;  /* –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –≤–∏—Å–æ—Ç—É –∫–Ω–æ–ø–∫–∏ */
    color: white;
    border: none;
    border-radius: 35px;
    cursor: pointer;
}
.video-title {
  display: flex;
  flex-direction: column;     /* –í–∏—Ä—ñ–≤–Ω—é—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
  word-wrap: break-word;      /* –ü–µ—Ä–µ–Ω–æ—Å —Å–ª—ñ–≤ */
  overflow-wrap: break-word;  /* –°—É—á–∞—Å–Ω–∏–π –ø–µ—Ä–µ–Ω–æ—Å */
  white-space: normal;    

}

        .photo-info { 
            text-align: left; 
            color: #b0bec5; 
            padding: 5px;
        }
       .avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    font-weight: bold;
    color: #ffffff;
    background: linear-gradient(90deg, rgba(42, 123, 155, 1) 0%, rgba(87, 199, 133, 1) 50%, rgba(237, 221, 83, 1) 100%);
    transition: background 0.5s ease, transform 0.3s ease;
    overflow: hidden; /* —â–æ–± img –Ω–µ –≤–∏—Ö–æ–¥–∏–ª–æ –∑–∞ –º–µ–∂—ñ –∫—Ä—É–≥–∞ */
}

.avatar:hover {
    transform: scale(1.1); /* –ª–µ–≥–∫–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
}

.avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
    opacity: 0;
    animation: fadeIn 0.5s forwards; /* –ø–ª–∞–≤–Ω–µ –∑‚Äô—è–≤–ª–µ–Ω–Ω—è */
}

/* –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—è–≤–∏ */
@keyframes fadeIn {
    to {
        opacity: 1;
    }
}
#account-form .avatar {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-right: 10px;
    font-weight: bold;
    color: #ffffff;
    background: linear-gradient(90deg, rgba(42, 123, 155, 1) 0%, rgba(87, 199, 133, 1) 50%, rgba(237, 221, 83, 1) 100%);
    transition: background 0.5s ease, transform 0.3s ease;
    overflow: hidden; /* —â–æ–± –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è –Ω–µ –≤–∏—Ö–æ–¥–∏–ª–æ –∑–∞ –º–µ–∂—ñ –∫—Ä—É–≥–∞ */
}

#account-form .avatar:hover {
    transform: scale(1.05); /* –ª–µ–≥–∫–µ –∑–±—ñ–ª—å—à–µ–Ω–Ω—è –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–Ω—ñ */
}

#account-form .avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
    opacity: 0;
    animation: fadeIn 0.5s forwards;
}
.smart-menu .avatar {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  overflow: hidden;
  display: flex;
  margin-left: 32%;
}

.smart-menu .avatar img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 50%;
  opacity: 0;
  animation: fadeIn 0.4s ease forwards;
}

/* –ê–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—è–≤–∏ */
@keyframes fadeIn {
    to {
        opacity: 1;
    }
}
        .video-details {
  width: 100%;
  display: block;
}
        #delete-account { 
            width: 100%;
    background-color: black;
    padding: 10px 0;
    margin: 10px 0;
border: 2px solid #333333;
    border-radius: 35px;
    border: none;
    outline: none;
    font-size: 1em;
        }
#delete-account:hover {
border-color: red;
box-shadow: 0 0 15px red; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è */

transform: translateY(-2px);
}
#delete-account:active {
border-color: red; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px red; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
.nsfw-label {
    background-color: red;
    color: white;
    font-weight: bold;
    padding: 5px 10px;
    border-radius: 5px;
    font-size: 14px;
    margin-top: 10px;  /* √Ç¬≥√§√±√≤√≥√Ø, √π√Æ√° √≤√•√™√±√≤ √≠√• √Ø√•√∞√•√™√∞√®√¢√†√¢√±√ø √ß ¬≥√≠√∏√®√¨√® √•√´√•√¨√•√≠√≤√†√¨√® */
    display: inline-block;
}
.menu.active {
  position: absolute;
  height: 100%;
  width: 240px;
}
.comments {
  overflow-y: auto;        /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Å–∫—Ä–æ–ª */
    max-height: 100%;        /* –ø–æ–≤–Ω–∞ –≤–∏—Å–æ—Ç–∞ */
    padding-right: 10px; 
    text-align: left;
}
.menu {
    background: rgb(26 26 26 / 68%);
    backdrop-filter: blur(12px);
    border-radius: 0 25px 25px 0;
    z-index: 100;
    position: fixed;
    top: 0;
    left: 0;
    width: 0;
    height: 100%;
    color: white;
    overflow-x: hidden;
    transition: width 0.3s ease-in-out;
    padding-top: 10px;
}
.smart-menu {
display: none;
}
.smart-menu a {
  width: 30%;
    height: 100%;
    padding: 10px 0px;
    text-decoration: none;
    color: white;
    display: grid;
    transition: 0.3s;
}
.menu a {
    border-radius: 35px;
    padding: 10px 15px;
    text-decoration: none;
    color: white;
    display: block;
    background: #111111;
    border: 2px solid #333333;
    transition: all 0.3s ease;
    box-shadow: 0 0 0 rgb(59 130 246 / 0%);
}

.menu a:hover {
    border-color: #f472b6; /* –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ –±–ª–∞–∫–∏—Ç–Ω–∏–º */

box-shadow: 0 0 15px #f472b6; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è */

transform: translateY(-2px); /* –ª–µ–≥–∫–µ –ø—ñ–¥–Ω—è—Ç—Ç—è */
        }
.menu a:active {
border-color: #06b6d4; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px #06b6d4; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
.content {
    transition: margin-left 0.3s ease-in-out;
}

.content-close {
  flex-grow: 1;
  padding: 0px;
  transition: margin-left 0.3s ease;
}
.content.active {
  margin-left: 240px;
}
#open-menu {
        display: flex;
}
.action-menu {
  position: absolute;
  bottom: 2%;
  left: 50%;

  padding: 12px 14px;
  border-radius: 18px;

  background: rgba(255, 255, 255, 0.12);
  backdrop-filter: blur(14px) saturate(160%);
  -webkit-backdrop-filter: blur(14px) saturate(160%);
  border: 1px solid rgba(255, 255, 255, 0.25);

  box-shadow: 0 12px 40px rgba(0, 0, 0, 0.35);

  z-index: 10000;

  animation: menuFadeScale .25s ease forwards;

  /* —â–æ–± –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –ª–∏–ø–Ω—É–≤ */
  display: flex;
}

/* üå´Ô∏è –º‚Äô—è–∫–∞ –∞–Ω—ñ–º–∞—Ü—ñ—è –ø–æ—è–≤–∏ */
@keyframes menuFadeScale {
  from {
    opacity: 0;
    transform: scale(.9) translateY(10px);
  }
  to {
    opacity: 1;
    transform: scale(1) translateY(0);
  }
}

/* üñ±Ô∏è hover –ø–æ –∫–Ω–æ–ø–∫–∞—Ö –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –º–µ–Ω—é */
.action-menu button {
  border-radius: 42px;
  background: rgba(0,0,0,0.25);
  color: white;
  border: 1px solid rgba(255,255,255,0.18);
  padding: 8px 12px;
  transition: .2s;
}

.action-menu button:hover {
  background: rgba(255,255,255,0.18);
}
.lightrope {
  text-align: center;
  white-space: nowrap;
  overflow: hidden;
  position: fixed;
  z-index: 1000;
  margin: 55px 0 0 0;
  padding: 0;
  pointer-events: none;
  width: 100%;
}

.lightrope li {
  position: relative;
  -webkit-animation-fill-mode: both;
  animation-fill-mode: both;
  -webkit-animation-iteration-count: infinite;
  animation-iteration-count: infinite;
  list-style: none;
  margin: 0;
  padding: 0;
  display: block;
  width: 12px;
  height: 28px;
  border-radius: 50%;
  margin: 20px;
  display: inline-block;
  background: #00f7a5;
  box-shadow: 0px 4.66667px 24px 3px #00f7a5;
  -webkit-animation-name: flash-1;
  animation-name: flash-1;
  -webkit-animation-duration: 2s;
  animation-duration: 2s;
}

.lightrope li:nth-child(2n+1) {
  background: cyan;
  box-shadow: 0px 4.66667px 24px 3px rgba(0, 255, 255, 0.5);
  -webkit-animation-name: flash-2;
  animation-name: flash-2;
  -webkit-animation-duration: 0.4s;
  animation-duration: 0.4s;
}

.lightrope li:nth-child(4n+2) {
  background: #f70094;
  box-shadow: 0px 4.66667px 24px 3px #f70094;
  -webkit-animation-name: flash-3;
  animation-name: flash-3;
  -webkit-animation-duration: 1.1s;
  animation-duration: 1.1s;
}

.lightrope li:nth-child(odd) {
  -webkit-animation-duration: 1.8s;
  animation-duration: 1.8s;
}

.lightrope li:nth-child(3n+1) {
  -webkit-animation-duration: 1.4s;
  animation-duration: 1.4s;
}

.lightrope li:before {
  content: "";
  position: absolute;
  background: #222;
  width: 10px;
  height: 9.33333px;
  border-radius: 3px;
  top: -4.66667px;
  left: 1px;
}

.lightrope li:after {
  content: "";
  top: -14px;
  left: 9px;
  position: absolute;
  width: 52px;
  height: 18.66667px;
  border-bottom: solid #222 2px;
  border-radius: 50%;
}

.lightrope li:last-child:after {
  content: none;
}

.lightrope li:first-child {
  margin-left: -40px;
}
#girland {
  display: none;
}
@-webkit-keyframes flash-1 {
  0%, 100% {
    background: #00f7a5;
    box-shadow: 0px 4.66667px 24px 3px #00f7a5;
  }
  50% {
    background: rgba(0, 247, 165, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(0, 247, 165, 0.2);
  }
}

@keyframes flash-1 {
  0%, 100% {
    background: #00f7a5;
    box-shadow: 0px 4.66667px 24px 3px #00f7a5;
  }
  50% {
    background: rgba(0, 247, 165, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(0, 247, 165, 0.2);
  }
}

@-webkit-keyframes flash-2 {
  0%, 100% {
    background: cyan;
    box-shadow: 0px 4.66667px 24px 3px cyan;
  }
  50% {
    background: rgba(0, 255, 255, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(0, 255, 255, 0.2);
  }
}

@keyframes flash-2 {
  0%, 100% {
    background: cyan;
    box-shadow: 0px 4.66667px 24px 3px cyan;
  }
  50% {
    background: rgba(0, 255, 255, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(0, 255, 255, 0.2);
  }
}

@-webkit-keyframes flash-3 {
  0%, 100% {
    background: #f70094;
    box-shadow: 0px 4.66667px 24px 3px #f70094;
  }
  50% {
    background: rgba(247, 0, 148, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(247, 0, 148, 0.2);
  }
}

@keyframes flash-3 {
  0%, 100% {
    background: #f70094;
    box-shadow: 0px 4.66667px 24px 3px #f70094;
  }
  50% {
    background: rgba(247, 0, 148, 0.4);
    box-shadow: 0px 4.66667px 24px 3px rgba(247, 0, 148, 0.2);
  }
}
.action-menu .delete-button:hover {
border-color: red; /* –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ —á–µ—Ä–≤–æ–Ω–∏–º */
border-radius: 30%;
  box-shadow: 0 0 10px red; /* –ª–µ–≥–∫–µ —Å–≤—ñ—Ç—ñ–Ω–Ω—è */
  transform: translateY(-2px); /* –ª–µ–≥–∫–µ –ø—ñ–¥–Ω—è—Ç—Ç—è */
}
.action-menu .delete-button:active {
border-color: red; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px red; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
#photo-container {
  display: none;
}
body.halloween {
  background: url('https://tickikids.ams3.cdn.digitaloceanspaces.com/z1.cache/gallery/activities/31203/image_5bd71b7f2e0287.38911859.jpg');
  background-size: 105% 105%; /* —Ç—Ä—ñ—à–∫–∏ –∑–±—ñ–ª—å—à–µ–Ω–∏–π, —â–æ–± –Ω–µ –±—É–ª–æ –±—ñ–ª–∏—Ö –∫—Ä–∞—ó–≤ */
  background-repeat: no-repeat;
  background-position: center;
  background-attachment: fixed;
  background-color: #000; /* —á–æ—Ä–Ω–∞ –ø—ñ–¥–∫–ª–∞–¥–∫–∞ –Ω–∞ –≤–∏–ø–∞–¥–æ–∫ –∑—Å—É–≤—É */
  color: #ff7518;
  transition: background 1s ease;
  animation: subtleBackgroundMove 25s ease-in-out infinite;
}

/* –ú'—è–∫–∏–π —Ä—É—Ö —Ñ–æ–Ω—É */
@keyframes subtleBackgroundMove {
  0% { background-position: center 0; }
  25% { background-position: calc(50% + 10px) 5px; }  /* —Ç—Ä–æ—Ö–∏ –≤–ø—Ä–∞–≤–æ —ñ –≤–Ω–∏–∑ */
  50% { background-position: calc(50% - 10px) -5px; } /* —Ç—Ä–æ—Ö–∏ –≤–ª—ñ–≤–æ —ñ –≤–≥–æ—Ä—É */
  75% { background-position: calc(50% + 8px) 2px; }   /* –∑–Ω–æ–≤—É –≤–ø—Ä–∞–≤–æ */
  100% { background-position: center 0; }             /* –Ω–∞–∑–∞–¥ */
}
.halloween button {
  background-color: #ff7518;
  color: black;
  border-radius: 35px;
}

.bat {
  animation: fly 12s linear infinite;
}

@keyframes fly {
  from { transform: translateX(-10vw) rotate(0deg); }
  to { transform: translateX(110vw) rotate(360deg); }
}

.fog {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTac0gfjeAI5QkLhujDIihfuGWT9fyJ_EnOJZPJNEM-UQ&s=10');
  background-size: cover;
  opacity: 0.2;
  animation: fogMove 20s linear infinite;
  pointer-events: none;
}

@keyframes fogMove {
  from { background-position: 0 0; }
  to { background-position: 100% 0; }
}
.hidden {
display: none;
}
/* üîç –ü–æ—à—É–∫–æ–≤–∏–π –±–ª–æ–∫ */
.search-box {
  position: fixed;
  top: 0;
  left: 0;
  width: 0;                      /* –ø–æ—á–∞—Ç–∫–æ–≤–æ —Å—Ö–æ–≤–∞–Ω–∏–π */
  height: 60px;
  background: aqua;
  color: black;
  display: flex;
  align-items: center;
  padding: 0 10px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
  transition: width 0.3s ease,   /* –ø–ª–∞–≤–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è */
              opacity 0.3s ease; /* –ø–ª–∞–≤–Ω–∞ –ø–æ—è–≤–∞ */
  opacity: 0;
  z-index: 9999;
  border-bottom-left-radius: 12px;
  border-bottom-right-radius: 12px;
}

/* –ö–æ–ª–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∏–π */
.search-box.open {
  width: 100%; 
  opacity: 1;
}

/* –ü–æ–ª–µ –≤–≤–æ–¥—É */
#search-input {
  flex: 1;
  color: : black;
  border: none;
  outline: none;
  font-size: 18px;

}

/* –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä–∏—Ç—Ç—è */
.search-close {
  background: none;
  border: none;
  cursor: pointer;
  padding: 10px;
}

.search-close i {
  font-size: 28px;
  color: black;
}

/* –ö–Ω–æ–ø–∫–∞ –ø–æ—à—É–∫—É —É navbar (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) */
.open--btn {
  background: none;
  border: none;
  cursor: pointer;
}
.modal-overlay, .modal-account-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(8px);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.modal-window {
  width: 90%;
  max-width: 450px;
  background: rgba(255,255,255,0.1);
  padding: 0;
  border-radius: 18px;
  max-height: 90vh;        /* —â–æ–± –Ω–µ –≤–∏—Ö–æ–¥–∏–ª–∞ –∑–∞ –µ–∫—Ä–∞–Ω */
    overflow: hidden;        /* —Ö–æ–≤–∞—î–º–æ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π —Å–∫—Ä–æ–ª */
    display: flex;
    flex-direction: column;
  border: 1px solid rgba(255,255,255,0.25);
  animation: scaleIn .3s ease;
}
.modal-account-body, .modal-body {
    overflow-y: auto;        /* –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–π —Å–∫—Ä–æ–ª */
    max-height: 100%;        /* –ø–æ–≤–Ω–∞ –≤–∏—Å–æ—Ç–∞ */
    padding-right: 10px;     /* —â–æ–± —Å–∫—Ä–æ–ª –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞–≤ –∫–æ–Ω—Ç–µ–Ω—Ç */
}
/* –†–æ–±–∏–º–æ —Ñ—ñ–∫—Å–æ–≤–∞–Ω—É –º–æ–¥–∞–ª–∫—É */

/* –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ —Ç—ñ–ª—å–∫–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–æ–Ω—Ç–µ–Ω—Ç—É */
.modal-header {
  display: flex;
  justify-content: space-between;
  padding: 12px 15px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}
.modal-account-header {
  display: flex;
  justify-content: right;
  padding: 12px 15px;
  border-bottom: 1px solid rgba(255,255,255,0.2);
}
.tab-button {
  cursor: pointer;
  font-weight: 600;
  color: #aaa;
}

.tab-button.active {
  color: #fff;
  border-bottom: 2px solid #fff;
}

.close-modal, .close-account-modal {

  cursor: pointer;
  color: #fff;
  font-size: 20px;
}

.tab-content {
  display: none;
  padding: 15px;
}

.tab-content.active {
  display: block;
}

@keyframes scaleIn {
  from { transform: scale(0.8); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}
.open--btn i {
  font-size: 28px;
}
nav {
    display: flex;
    justify-content: center;
    padding: 0px 20px;
    background: rgb(26 26 26 / 68%);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border-radius: 16px;
    box-shadow: 0 8px 32px rgb(0 0 0 / 20%);
    position: fixed;
    z-index: 100;
    width: 97%;
        }
        nav a {
height: 50px;
align-items: center;
    justify-content: center;
display: flex;
    padding: 0px 5px;
    border-radius: 50px;
    text-align: center;
    text-decoration: none;
    color: white;
    background: #111111;
    border: 2px solid #333333;
    transition: all 0.3s ease;
    box-shadow: 0 0 0 rgb(59 130 246 / 0%);
        }
        nav a:hover {
            border-color: #f472b6; /* –ø—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è —Ä–∞–º–∫–∏ –±–ª–∞–∫–∏—Ç–Ω–∏–º */

box-shadow: 0 0 15px #f472b6; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è */

transform: translateY(-2px); /* –ª–µ–≥–∫–µ –ø—ñ–¥–Ω—è—Ç—Ç—è */
        }
nav a:active {
border-color: #06b6d4; /* —Ä–∞–º–∫–∞ —Ä–æ–∂–µ–≤–æ–≥–æ –∫–æ–ª—å–æ—Ä—É –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

box-shadow: 0 0 10px #06b6d4; /* —Å–≤—ñ—Ç—ñ–Ω–Ω—è –ø—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ */

transform: scale(0.95); /* –ª–µ–≥–∫–µ —Å—Ç–∏—Å–Ω–µ–Ω–Ω—è */
}
        .icon-text {
            margin-left: 5px;
        }

        @media (max-width: 768px) {
            .icon-text {
                display: none;
            }
        #upload-link {
        display: none;
    }
    #plus-desktop-button {
      display: none;
    }
    #upload-link-photo {
        display: none;
    }
    #smart-upload-link {
        display: none;
    }
                .modal {
  display: none;
  position: fixed;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.5);
}

.modal-content {
  background: white;
  padding: 20px;
  margin: 20% auto;
  width: 300px;
  text-align: center;
  border-radius: 10px;
}


.delete-button {
display: flex;
padding: 3px 8px;
align-items: center; 
justify-content: center;
text-decoration: none;
  border-radius: 10px;
  border: 2px solid transparent; /* –ø–æ—á–∞—Ç–∫–æ–≤–æ –±–µ–∑ –æ–±–≤–æ–¥–∫–∏ */
  background-color: #111;
  border-color: #111; /* —á–æ—Ä–Ω–∏–π —Ñ–æ–Ω –∞–±–æ —ñ–Ω—à–∏–π */
  color: white;
  cursor: pointer;
  font-weight: 600;
  transition: border-color 0.3s, transform 0.2s, box-shadow 0.3s;
}
#plus-button {
  width: 10%;
 height: 10%;
  font-size: 32px;
  border-radius: 89px;
  border: 2px solid white;
  transition: 0.3s;
  z-index: 999;
  display: flex;
  justify-content: center;
  align-items: center;
}
#plus-button.open {
  transform: rotate(45deg);
  border-color: red;
  box-shadow: 0 0 15px red;
}
.comments * {
    white-space: normal;
    word-break: break-word;
}
      .smart-menu {
  position: fixed;
  bottom: 10px;
  left: 50%;
  transform: translateX(-50%);
  width: 90%;
  max-width: 600px;
  display: flex;
  justify-content: space-around;
  align-items: center;
  padding: 10px 20px;
  border-radius: 65px;
  isolation: isolate;
  z-index: 1000;
}
#timer {
            font-size: 20px;
            color: red;
        }
        #alert {
            display: none;
            background-color: yellow;
            padding: 10px;
            margin-top: 10px;
            font-size: 18px;
        }
        input[type="number"] {
            padding: 5px;
            margin: 10px 0;
        }
        .save {
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        .save:hover {
            background-color: #45a049;
        }
        }
 #nsfw-toggle {
        display: none;
}
            }
    </style>
</head>
<body> 

 <nav>
        <div style="display: flex; align-items: center;">
            <a href="#" id="open-menu" onclick="toggleSidebar()">
    <i class="material-icons">menu</i>
</a>
<img src="VideoVortex_logo.ico" id="logo" style="height: 50px; width: 50px; border-radius: 50%;">
            <a href="beta.html">
            <h1 style="padding-left: 5px;">VideoVortex</h1><sup style="margin-left: 3px; font-size: 0.6em;">beta</sup><sup><div id="timer"></div></sup></a>
        </div>
        <button onclick="openSearch()">
  <i class="material-icons">search</i>
</button>
        <div style="display: flex; gap: 15px; margin-left: auto;">
           <a href="#" id="plus-desktop-button"><i class="material-icons">add</i></a>
            <a href="auth-beta.html" id="auth-link">
                <i class="material-icons">login</i><span class="icon-text">–£–≤—ñ–π—Ç–∏</span>
            </a>
            <a href="auth-beta.html" id="register-link">
                <i class="material-icons">person_add</i><span class="icon-text">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</span>
            </a>
            <a href="#" id="logout-link" style="display: none;">
                <i class="material-icons">logout</i><span class="icon-text">–í–∏–π—Ç–∏</span>
                </a>
            <a href="#" id="account-link-desktop" onclick="openAccountModal()" style="display: none;">
                <i class="material-icons">person</i><span class="icon-text" id="email">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
            </a>
                    <button data-i18n="installBtn" id="installBtn" style="display:none; width: 128px; right: 152px; position: fixed; top: 82px;">–í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –¥–æ–¥–∞—Ç–æ–∫</button>
        </div>
    </nav>
    <div id="search-box" class="search-box">
  <input type="text" id="search-input" placeholder="–ü–æ—à—É–∫..." oninput="searchVideos()">
  <button id="close-search" class="search-close">
    <i class="material-icons">close</i>
  </button>
  </div>
<div id="rules-update-modal" class="ios-modal">
  <div class="ios-modal-content">
    <h2>üîî –û–Ω–æ–≤–ª–µ–Ω—ñ –ø—Ä–∞–≤–∏–ª–∞</h2>
    <p>–ú–∏ –æ–Ω–æ–≤–∏–ª–∏ –ø—Ä–∞–≤–∏–ª–∞ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏ VideoVortex:</p>
    <ul>
      <li>üö´ –ó–∞–±–æ—Ä–æ–Ω–µ–Ω–æ —Ñ–µ–π–∫–∏ —Ç–∞ –æ–±—Ä–∞–∑–∏.</li>
      <li>üîí –ü–æ—Å–∏–ª–µ–Ω–æ –ø—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—ñ.</li>
      <li>üßí –û–±–º–µ–∂–µ–Ω–Ω—è –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –¥–æ 16 —Ä–æ–∫—ñ–≤.</li>
    </ul>
    <div class="modal-divider"></div>
    <button id="agree-btn" onclick="acceptRulesUpdate()">–ó—Ä–æ–∑—É–º—ñ–ª–æ</button>
  </div>
</div>

<div id="upload-modal" class="modal-overlay">
  <div class="modal-window">
    <div class="modal-header">
      <span data-i18n="tab-button active" class="tab-button active" data-tab="video-tab">–í—ñ–¥–µ–æ</span>
      <span data-i18n="tab-button" class="tab-button" data-tab="photo-tab">–§–æ—Ç–æ</span>
      <span class="close-modal">‚úñ</span>
    </div>

    <div class="modal-body">
      <!-- –í–∫–ª–∞–¥–∫–∞ "–í—ñ–¥–µ–æ" -->
      <div id="video-tab" class="tab-content active">
                <div class="upload-form" id="upload-form">
            <h2 data-i18n="label-video">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—ñ–¥–µ–æ</h2>
            <input type="text" id="video-title" placeholder="–ù–∞–∑–≤–∞ –≤—ñ–¥–µ–æ">
            <textarea id="video-description" placeholder="–û–ø–∏—Å –≤—ñ–¥–µ–æ"></textarea>
            <button onclick="generateDescription()">ü§ñ –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –æ–ø–∏—Å</button>
        <p id="video-file-name" style="margin-top:10px; font-size:14px; color:#ccc;">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</p>
  <label for="video-file" class="video-label">
  <i class="material-icons">cloud_upload</i> –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—ñ–¥–µ–æ
</label>
<input type="file" id="video-file" accept="video/*">
<br>
<select id="video-channel-select">
  <option value="main">–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª</option>
  <option value="second">–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª</option>
</select>
<br>
<span>–í–∏–º–∫–Ω—É—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ <sup style="background-color: blue; color: white; border-radius: 8px;">NEW</sup></span><label class="switch" for="disabled-comments-checkbox"><input type="checkbox" id="disabled-comments-checkbox"><span class="slider round"></span></label>        
     <br>
     <br>
   <span>–ü—Ä–∏–≤–∞—Ç–Ω–µ –≤—ñ–¥–µ–æ</span><label class="switch" for="private-checkbox"><input type="checkbox" id="private-checkbox"><span class="slider round"></span></label>
<div id="domain-restrict-container" style="margin-top: 10px;">
    <br>
        <span>–¢—ñ–ª—å–∫–∏ –¥–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∑ –¥–æ–º–µ–Ω–æ–º kfccte-nau.ukr.education</span><label class="switch">
        <input type="checkbox" id="domain-restrict-checkbox"><span class="slider round"></span></label>
</div>
<br>

           <label id="nsfw"><input type="checkbox" id="nsfw-checkbox">–ü–æ–∑–Ω–∞—á–∏—Ç–∏ –≤—ñ–¥–µ–æ —è–∫ NSFW</label>
           <br>
    <div id="bandura-options" style="display:none; margin-top:10px;">
      
      <h3>üéµ –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–∞–Ω–¥—É—Ä–∏</h3>

  <label>
    <input type="checkbox" id="bandura-video">
    –¶–µ –±–∞–Ω–¥—É—Ä–Ω–µ –≤—ñ–¥–µ–æ
  </label>

  <br><br>

  <label>
    –¢–∏–ø –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
    <select id="bandura-style">
      <option value="–°–æ–ª–æ">–°–æ–ª–æ</option>
      <option value="–î—É–µ—Ç">–î—É–µ—Ç</option>
      <option value="–ê–Ω—Å–∞–º–±–ª—å">–ê–Ω—Å–∞–º–±–ª—å</option>
    </select>
  </label>

  <br><br>

  <label>
    –¢–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å:
    <input type="text" id="bandura-key" placeholder="–ù–∞–ø—Ä. D minor">
  </label>

  <br><br>

  <label>
    –†—ñ–≤–µ–Ω—å —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ:
    <select id="bandura-difficulty">
      <option value="–ü–æ—á–∞—Ç–∫–æ–≤–∏–π">–ü–æ—á–∞—Ç–∫–æ–≤–∏–π</option>
      <option value="–°–µ—Ä–µ–¥–Ω—ñ–π">–°–µ—Ä–µ–¥–Ω—ñ–π</option>
      <option value="–í–∏—Å–æ–∫–∏–π">–í–∏—Å–æ–∫–∏–π</option>
    </select>
  </label>

  <br><br>
  <!-- –î–æ–¥–∞—Ç–∫–æ–≤—ñ –∞—É–¥—ñ–æ/–≤—ñ–¥–µ–æ –æ–ø—Ü—ñ—ó -->
  <label>
    –¢–µ–º–ø (BPM):
    <input type="number" id="bandura-tempo" min="40" max="240" placeholder="120">
  </label>

  <br><br>

  <label>
    –†–µ–∂–∏–º —Å–ø–æ–≤—ñ–ª—å–Ω–µ–Ω–æ–≥–æ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è:
    <input type="checkbox" id="bandura-slow">
    –î–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è
  </label>

  <br><br>

  <!-- –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∑–∞–ø–∏—Å -->
  <label>
    –ú—ñ—Å—Ü–µ/–ø–æ–¥—ñ—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è:
    <input type="text" id="bandura-event" placeholder="–ö–æ–Ω—Ü–µ—Ä—Ç, —Å—Ç—É–¥—ñ—è, –æ–Ω–ª–∞–π–Ω">
  </label>

  <br><br>

  <label>
    –†—ñ–∫ –∑–∞–ø–∏—Å—É:
    <input type="number" id="bandura-year" min="1900" max="2100" placeholder="2026">
  </label>

  <br><br>

  <label>
    –í–∏–∫–æ–Ω–∞–≤–µ—Ü—å / –ê—Ä–∞–Ω–∂—É–≤–∞–ª—å–Ω–∏–∫:
    <input type="text" id="bandura-performer" placeholder="–Ü–º'—è –≤–∏–∫–æ–Ω–∞–≤—Ü—è –∞–±–æ –∞–Ω—Å–∞–º–±–ª—é">
  </label>

  <br><br>

  <label>
    –ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ / —Ç–µ–≥–∏:
    <input type="text" id="bandura-tags" placeholder="–±–∞–Ω–¥—É—Ä–∞, –µ—Ç–Ω–æ, –∫–æ–Ω—Ü–µ—Ä—Ç">
  </label>

  <br><br>

  <!-- –ú–∞—Ä–∫–µ—Ä–∏ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è -->
  <label>
    –ú–∞—Ä–∫–µ—Ä–∏ —Ä–æ–∑–¥—ñ–ª—ñ–≤ (–∫—É–ø–ª–µ—Ç, –ø—Ä–∏—Å–ø—ñ–≤, —Å–æ–ª–æ):
    <input type="text" id="bandura-markers" placeholder="0:00 - –≤—Å—Ç—É–ø, 0:30 - –∫—É–ø–ª–µ—Ç">
  </label>

</div>
            <div id="progress-container" style="display: none; margin-top: 10px;">
              <p id="progress-text"></p>
                <progress id="upload-progress" value="0" max="100"></progress>
                <span id="progressicon-text">0%</span>
<span id="time-left"></span>
            </div>
  
            <button id="upload-button" onclick="uploadVideo()">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
<label>–ü—É–±–ª—ñ–∫—É—é—á–∏ –≤—ñ–¥–µ–æ, –≤–∏ –ø–æ–≥–æ–¥–∂—É—î—Ç–µ—Å—è –∑ <a href="https://telegra.ph/Pravila-sp%D1%96lnoti-VideoVortex-09-14-2" target="_blank">–ø—Ä–∞–≤–∏–ª–∞–º–∏ —Å–ø—ñ–ª—å–Ω–æ—Ç–∏.</a></label>
</div>
      </div>

      <!-- –í–∫–ª–∞–¥–∫–∞ "–§–æ—Ç–æ" -->
      <div id="photo-tab" class="tab-content">
<div class="upload-photo-form" id="upload-photo-form">
            <h2 data-i18n="label-photo">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ</h2>
            <input type="text" id="photo-title" placeholder="–ù–∞–∑–≤–∞ –§–æ—Ç–æ">
            <textarea id="photo-description" placeholder="–û–ø–∏—Å –§–æ—Ç–æ"></textarea>
            <p id="file-name" style="margin-top:10px; font-size:14px; color:#ccc;">–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ</p>
<label for="photo-file" class="photo-label">
  <i class="material-icons">cloud_upload</i><p data-i18n="label-photo">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ</p>
</label>
<input type="file" id="photo-file" accept="image/*">
            <br>
            <select id="photo-channel-select">
  <option value="main" data-i18n="main-channel">–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª</option>
  <option value="second">–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª</option>
</select>
<br>
            <div id="progress-photo-container" style="display: none; margin-top: 10px;">
                <progress id="upload-photo-progress" value="0" max="100"></progress>
                <span id="progressicon-photo-text">0%</span>
            </div>
            <button id="upload-button" onclick="uploadPhoto()">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
        </div>
      </div>
    </div>
  </div>
</div>
      <ul id="girland">
  <li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li>
</ul>
<div id="tg-popup" class="tg-popup hidden">
  <div class="tg-popup-card">
    <button class="tg-close" onclick="closeTgPopup()">‚úï</button><h3>üì¢ –ú–∏ –≤ Telegram</h3>
    <p>–ù–æ–≤–∏–Ω–∏, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –º–æ–¥–µ—Ä–∞—Ü—ñ—è VideoVortex</p><a href="https://t.me/fantasticelectronics" target="_blank" class="tg-join-btn">
      –ü–µ—Ä–µ–π—Ç–∏ –≤ Telegram</a>
  </div>
</div>
<div id="account-modal" class="modal-account-overlay">
  <div class="modal-window">
    <div class="modal-account-header">
      <span class="close-account-modal">‚úñ</span>
    </div>
    <div class="modal-account-body">
<div class="account-form" id="account-form">
            <h2>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞–∫–∞—É–Ω—Ç</h2>
<div class="avatar" id="profile-avatar"></div>
<input type="file" id="avatar-input" accept="image/*" hidden>
<button id="change-avatar">–ó–º—ñ–Ω–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä</button>
<p id="name">–Ü–º'—è: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p><button id="button-name" onclick="editName()"><i class="material-icons">edit</i>–ó–º—ñ–Ω–∏—Ç–∏</button>
<div id="form-edit-name" style="display:none;">
<input type="text" id="edit-name">
<button id="save-name" onclick="saveEditName()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
</div>
<p id="supername">–ü—Ä—ñ–∑–≤–∏—â–µ: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p><button href="#" id="button-supername" onclick="editSuperName()"><i class="material-icons">edit</i>–ó–º—ñ–Ω–∏—Ç–∏</button>
<div id="form-edit-supername" style="display:none;">
<input type="text" id="edit-supername">
<button id="save-supername" onclick="saveEditSuperName()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
</div>
<input id="second-channel-name" placeholder="–ù–∞–∑–≤–∞ –¥—Ä—É–≥–æ–≥–æ –∫–∞–Ω–∞–ª—É">
<button onclick="createSecondChannel()">‚ûï –°—Ç–≤–æ—Ä–∏—Ç–∏ –¥—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª</button>
<select id="language-select">
  <option value="en">English</option>
  <option value="ua">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
</select>
            <p id="user-info"></p>
<p id="view">–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
        <div id="requests-container"></div>
<button id="delete-account" onclick="deleteAccount()"><i class="material-icons">person_remove</i><span style="margin-left: 5px;">–í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</span></button>
        <label>
       <span>–ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—ñ —è–∫ NSFW <sup style="background-color: blue; color: white; border-radius: 8px;">NEW</sup></span><label class="switch">
          <input type="checkbox" id="show-nsfw-videos"><span id="slidernsfw" class="slider round"></span></label>
        <p id="information-nsfw">–í–∞–º –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 18 —Ä–æ–∫—ñ–≤, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ NSFW –≤—ñ–¥–µ–æ.</p>
<h1>–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω–Ω–æ–≥–æ —á–∞—Å—É</h1>
    <p>–í–∫–∞–∂—ñ—Ç—å, —Å–∫—ñ–ª—å–∫–∏ —Ö–≤–∏–ª–∏–Ω –Ω–∞ –¥–µ–Ω—å –≤–∏ —Ö–æ—á–µ—Ç–µ –±—É—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:</p>
    <input type="number" id="maxTimeInput" value="45" min="1" />
    <button class="save" onclick="saveSettings()">–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</button>

    <p>–í–∫–∞–∂—ñ—Ç—å —á–∞—Å —Å–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 21:00 - 07:00):</p>
    <label for="sleepStart">–ß–∞—Å –ø–æ—á–∞—Ç–∫—É —Å–Ω—É:</label>
    <input type="time" id="sleepStart" value="21:00">

    <label for="sleepEnd">–ß–∞—Å –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —Å–Ω—É:</label>
    <input type="time" id="sleepEnd" value="07:00">
                </div>
      </div>
    </div>
  </div>
</div>
<div class="edit-form" id="edit-form" style="display: none;">
            <h2>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ</h2>
            <input type="text" id="edit-video-title" placeholder="–ù–∞–∑–≤–∞ –≤—ñ–¥–µ–æ">
            <textarea id="edit-video-description" placeholder="–û–ø–∏—Å –≤—ñ–¥–µ–æ"></textarea>
 <span>–ü—Ä–∏–≤–∞—Ç–Ω–µ –≤—ñ–¥–µ–æ</span><label class="switch" for="edit-private-checkbox"><input type="checkbox" id="edit-private-checkbox"><span class="slider round"></span></label>
            <button id="edit-button" onclick="saveVideoChanges()">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
        </div>

        <div  class="smart-menu">
          <div class="bg-liquid-glass">
 <a class="button-liquid-glass" href="#" id="smart-video" onclick="video()">
        <i class="material-icons">movie</i><span>–í—ñ–¥–µ–æ</span>
    </a>
    <a  href="#" id="plus-button"><i class="material-icons">add</i></a>
       <a href="#" id="smart-post" onclick="post()">
        <i class="material-icons">photo</i><span>–î–æ–ø–∏—Å–∏</span>
        </a>
        <a href="#" id="account-link" onclick="openAccountModal()">
<i class="avatar" id="nav-avatar"></i><span>–í–∏</span>
    </a>
</div>
</div>

                <div class="menu" style="align-items: center;">
    <a href="#" id="close-menu" onclick="closeSidebar()">
        <i class="material-icons">close</i>
    </a>
    <a href="#" id="post" onclick="post()">
        <i class="material-icons">photo</i><span style="margin-left: 5px">–î–æ–ø–∏—Å–∏</span>
    </a>
    <a class="bg-liquid-glass" href="#" id="video" onclick="video()">
        <i class="material-icons">movie</i><span style="margin-left: 5px">–í—ñ–¥–µ–æ</span>
    </a>
</div>
<div id="birthdate-modal" style="
  display: none;
  position: fixed;
  z-index: 9999;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  backdrop-filter: blur(20px);
  justify-content: center;
  align-items: center;
  animation: fadeIn 0.3s ease;
">
  <input type="text" id="name-input" placeholder="–Ü–º'—è" style="padding: 10px; font-size: 1em;">
<input type="text" id="supername-input" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ" style="padding: 10px; font-size: 1em;">
<h2>–í–∫–∞–∂—ñ—Ç—å –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è</h2>
  <input type="date" id="birthdate-input" style="padding: 10px; font-size: 1em;">
  <button onclick="submitBirthdate()" style="margin-top: 10px; padding: 10px 20px;">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
</div>
<div id="newyear-easter-egg" class="ny-popup">
  <div class="ny-content">
    <h2>üéÜ –ó –ù–æ–≤–∏–º 2026 —Ä–æ–∫–æ–º! üéÜ</h2>
    <p>
      ‚ùÑÔ∏è –°—ñ—é, –≤—ñ—é, –∑–∞—Å—ñ–≤–∞—é ‚Äî<br>
      –º–∏—Ä—É, —â–∞—Å—Ç—è —ñ –¥–æ–±—Ä–∞ –±–∞–∂–∞—é!<br><br>
      üéÑ –ù–µ—Ö–∞–π VideoVortex —Ä–æ—Å—Ç–µ,<br>
      –∞ –º—Ä—ñ—ó –∑–±—É–≤–∞—é—Ç—å—Å—è!
    </p>
    <button onclick="closeNewYearPopup()">‚ú® –î—è–∫—É—é</button>
  </div>
</div>
    <div class="container" id="video-container">

        <div class="video-container" id="video-gallery"></div>

    </div>

    <div class="container" id="photo-container">
        <div class="photo-container" id="photo-gallery"></div>

    </div>
        <footer style="text-align: center; justify-content: center; gap: 30px; padding: 10px 20px; background: rgb(26 26 26 / 68%); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); border-radius: 16px; box-shadow: 0 8px 32px rgb(0 0 0 / 20%); width: 97%;">
                <h3>–í–µ—Ä—Å—ñ—è –¥–æ–¥–∞—Ç–∫–∞:</h3>
                <p>4.1.0</p>
        </footer>
<script>
document.addEventListener("DOMContentLoaded", () => {
    initLanguageSwitcher("language-select");
});
</script>

        <script>
const modal = document.getElementById("upload-modal");
const accountModal = document.getElementById("account-modal");
const buttonAccountModal = document.getElementById("account-link");
const closeAccountModal = document.querySelector(".close-account-modal");
const plus = document.getElementById("plus-button");
const plusDesktop = document.getElementById("plus-desktop-button");
const closeBtn = document.querySelector(".close-modal");
const tabButtons = document.querySelectorAll(".tab-button");
const tabContents = document.querySelectorAll(".tab-content");

function requireAuth(action) {
    if (!auth.currentUser) {
        alert("–©–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ü—é –¥—ñ—é, —É–≤—ñ–π–¥—ñ—Ç—å —É –∞–∫–∞—É–Ω—Ç.");
        window.location.href = "auth-beta.html";
        return false;
    }
    return true;
}

// –í—ñ–¥–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–æ–∫
plus?.addEventListener("click", () => {
    if (!requireAuth()) return;
    modal.style.display = "flex";
});
plusDesktop?.addEventListener("click", () => {
    if (!requireAuth()) return;
    modal.style.display = "flex";
});

buttonAccountModal?.addEventListener("click", () => {
    if (!requireAuth()) return;
    accountModal.style.display = "flex";
});

// –ó–∞–∫—Ä–∏—Ç—Ç—è –º–æ–¥–∞–ª–æ–∫
closeAccountModal?.addEventListener("click", () => accountModal.style.display = "none");
closeBtn?.addEventListener("click", () => modal.style.display = "none");

// –ó–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –º–æ–¥–∞–ª–∫–æ—é
[modal, accountModal].forEach(m => {
    m?.addEventListener("click", e => {
        if (e.target === m) m.style.display = "none";
    });
});

// –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∫–ª–∞–¥–æ–∫
tabButtons.forEach(btn => {
    btn.addEventListener("click", () => {
        tabButtons.forEach(b => b.classList.remove("active"));
        tabContents.forEach(c => c.classList.remove("active"));

        btn.classList.add("active");
        const tabId = btn.dataset.tab;
        document.getElementById(tabId)?.classList.add("active");
    });
});
</script>
        <script>
          const searchBox = document.getElementById("search-box");
const closeSearch = document.getElementById("close-search");
const searchInput = document.getElementById("search-input");

function openSearch() {
    searchBox.classList.add("open");
    setTimeout(() => searchInput.focus(), 150);
}

closeSearch.addEventListener("click", () => {
    searchBox.classList.remove("open");
    searchInput.value = "";
    searchVideos();
});
function searchVideos() {
    const query = document.getElementById("search-input").value.toLowerCase();

    const videos = document.querySelectorAll(".video-item");

    videos.forEach(video => {
        const title = video.dataset.title.toLowerCase();
        const description = video.dataset.description.toLowerCase();
        const author = video.dataset.author.toLowerCase();

        if (title.includes(query) || description.includes(query) || author.includes(query)) {
            video.parentElement.style.display = "flex"; // –ø–æ–∫–∞–∑—É—î–º–æ –∫–∞—Ä—Ç–∫—É
        } else {
            video.parentElement.style.display = "none"; // —Ö–æ–≤–∞—î–º–æ –≤—Å—é –∫–∞—Ä—Ç–∫—É
        }
    });
}
        </script>
        <script>
const fileInput = document.getElementById("photo-file");
const fileName = document.getElementById("file-name");

fileInput.addEventListener("change", () => {
  const name = fileInput.files.length ? fileInput.files[0].name : "–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ";
  fileName.textContent = "üì∏ " + name;
});
</script>
        <script>
const videoInput = document.getElementById("video-file");
const videofileName = document.getElementById("video-file-name");

videoInput.addEventListener("change", () => {
  const name = videoInput.files.length ? videoInput.files[0].name : "–§–∞–π–ª –Ω–µ –≤–∏–±—Ä–∞–Ω–æ";
  videofileName.textContent = "üìΩ " + name;
});

</script>
<script>
function isMobile() {
  return window.innerWidth <= 768;
}

function showTgPopup() {
  if (!localStorage.getItem("tg_popup_seen") && isMobile()) {
    document.getElementById("tg-popup").classList.remove("hidden");
  }
}

function closeTgPopup() {
  document.getElementById("tg-popup").classList.add("hidden");
  localStorage.setItem("tg_popup_seen", "1");
}

window.addEventListener("load", () => {
  setTimeout(showTgPopup, 1500);
});
</script>
<script>
let logoClickCount = 0;
let logoClickTimer = null;
let easterEggTimeout = null;
let snowInterval = null;

document.addEventListener("DOMContentLoaded", () => {
  const today = new Date();
  const month = today.getMonth() + 1;
  const day = today.getDate();

  const logo = document.getElementById("logo"); // –û—Ç—Ä–∏–º—É—î–º–æ –ª–æ–≥–æ—Ç–∏–ø

  // üéÉ HALLOWEEN: 30-31 –∂–æ–≤—Ç–Ω—è
  if (month === 10 && (day === 30 || day === 31)) {
    activateHalloweenMode();
    applyIcons(halloweenIcons);
  }

  // –í–∏–º–∫–Ω–µ–Ω–Ω—è Halloween 1 –ª–∏—Å—Ç–æ–ø–∞–¥–∞
  if (month === 11 && day === 1) {
    deactivateHalloweenMode();
    restoreIcons();
  }

  // üéÑ NEW YEAR: 25 –≥—Ä—É–¥–Ω—è ‚Üí 14 —Å—ñ—á–Ω—è

  const isNewYear = (month === 12 && day >= 15) || (month === 1 && day <= 25);
  if (isNewYear) {
    activateGirland();
    activateNewYearMode();
    applyIcons(newyearIcons);
  } else {
    deactivateGirland();
    deactivateNewYearMode();
   if (!(month === 2 && (day === 13 || day === 14))) {
      restoreIcons();
   }
  }
if (month === 2 && (day === 13 || day === 14)) {
    applyIcons(valentineIcons);
  }
  // üîî Easter egg –ø–æ –ø–æ—Ç—Ä—ñ–π–Ω–æ–º—É –∫–ª—ñ–∫—É –Ω–∞ –ª–æ–≥–æ—Ç–∏–ø
  if (logo) {
    logo.addEventListener("click", () => {
      logoClickCount++;

      if (logoClickCount === 1) {
        logoClickTimer = setTimeout(() => {
          logoClickCount = 0;
        }, 1200);
      }

      if (logoClickCount === 3) {
        clearTimeout(logoClickTimer);
        logoClickCount = 0;
        launchNewYearEasterEgg();
      }
    });
  }
});
/* ================================
   üéÉ HALLOWEEN
   ================================ */
function activateHalloweenMode() {
  document.body.classList.add("halloween");
  console.log("üéÉ Halloween —É–≤—ñ–º–∫–Ω–µ–Ω–æ!");
  styleButtons("#ff7518", "black");

  for (let i = 0; i < 5; i++) {
    const bat = document.createElement("div");
    bat.className = "bat";
    bat.textContent = "ü¶á";
    bat.style.position = "fixed";
    bat.style.top = Math.random() * 80 + "%";
    bat.style.left = Math.random() * 100 + "%";
    bat.style.fontSize = Math.random() * 30 + 20 + "px";
    bat.style.opacity = 0.8;
    bat.style.zIndex = 9999;
    document.body.appendChild(bat);
  }

  const fog = document.createElement("div");
  fog.className = "fog";
  fog.style.position = "fixed";
  fog.style.top = "0";
  fog.style.left = "0";
  fog.style.width = "100%";
  fog.style.height = "100%";
  fog.style.background =
    "radial-gradient(circle, rgba(255,165,0,0.1), rgba(0,0,0,0.8))";
  fog.style.pointerEvents = "none";
  fog.style.zIndex = 999;
  document.body.appendChild(fog);
}

function deactivateHalloweenMode() {
  document.body.classList.remove("halloween");
  document.querySelectorAll(".bat, .fog").forEach(el => el.remove());
  resetButtonColors();
}

/* ================================
   üéÑ NEW YEAR
   ================================ */
function activateGirland() {
  const girland = document.getElementById("girland");
  if (girland) {
    girland.style.display = "block";
    girland.classList.add("lightrope");
  }
}

function deactivateGirland() {
  const girland = document.getElementById("girland");
  if (girland) {
    girland.classList.remove("lightrope");
    girland.style.display = "none";
  }
}

function activateNewYearMode() {
  document.body.classList.add("newyear");
  console.log("üéÑ –ù–æ–≤–∏–π –†—ñ–∫ —É–≤—ñ–º–∫–Ω–µ–Ω–æ!");
  startSnow();

  const logo = document.getElementById("logo");
  if (logo && !logo.dataset.originalSrc) logo.dataset.originalSrc = logo.src;
  if (logo) logo.src = "VideoVortex_new_year's_logo.jpg";

  styleButtons("#b0e6ff", "#00344f");
}

function deactivateNewYearMode() {
  document.body.classList.remove("newyear");
  stopSnow();

  const logo = document.getElementById("logo");
  if (logo && logo.dataset.originalSrc) logo.src = logo.dataset.originalSrc;

  resetButtonColors();
}

/* ================================
   ‚ùÑÔ∏è SNOWFALL & Easter Egg
   ================================ */
function startSnow() {
  if (snowInterval) return;

  snowInterval = setInterval(() => {
    const flake = document.createElement("div");
    flake.className = "snowflake";
    flake.textContent = ["‚ùÑÔ∏è", "‚ùÖ", "‚ùÜ"][Math.floor(Math.random() * 3)];
    flake.style.position = "fixed";
    flake.style.left = Math.random() * 100 + "vw";
    flake.style.top = "-10px";
    flake.style.fontSize = Math.random() * 25 + 10 + "px";
    flake.style.opacity = Math.random() * 0.8 + 0.2;
    flake.style.animation = "fall 4s linear forwards";
    flake.style.pointerEvents = "none";
    flake.style.zIndex = 9999;
    document.body.appendChild(flake);
    setTimeout(() => flake.remove(), 5000);
  }, 150);
}

function stopSnow() {
  clearInterval(snowInterval);
  snowInterval = null;
  document.querySelectorAll(".snowflake").forEach(f => f.remove());
}

function launchNewYearEasterEgg() {
  startSnow();

  const popup = document.getElementById("newyear-easter-egg");
  if (!popup) return;

  popup.style.display = "flex";

  if (easterEggTimeout) {
    clearTimeout(easterEggTimeout);
  }

  easterEggTimeout = setTimeout(() => {
    popup.style.display = "none";
  }, 120000);
}
function closeNewYearPopup() {
const popupClose = document.getElementById("newyear-easter-egg");
popupClose.style.display = "none";
}
/* ================================
   üî≥ ICON SYSTEM
   ================================ */
const halloweenIcons = {
  "account-link": (user) => `üï∏<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "üï∏",
  "logout-link": "üö™",
  "auth-link": "üö™",
  "smart-post": "üëª<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "ü¶á<span>–í—ñ–¥–µ–æ</span>",
  "": "üëª<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "ü¶á<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üéÉ",
  "plus-desktop-button": "üéÉ"
};

const newyearIcons = {
  "account-link": (user) => `‚õÑ<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "‚õÑ",
  "logout-link": "üö™",
  "auth-link": "üö™",
  "smart-post": "‚ùÑÔ∏è<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "üé¨<span>–í—ñ–¥–µ–æ</span>",
  "post": "‚ùÑÔ∏è<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "üé¨<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üéÑ",
  "plus-desktop-button": "üéÑ"
};
const valentineIcons = {
  "account-link": (user) =>
    `‚ù§Ô∏è<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "üíñ",
  "logout-link": "üö™",
  "auth-link": "üíò",
  "smart-post": "üíå<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "üíû<span>–í—ñ–¥–µ–æ</span>",
  "": "üíå<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "üíû<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üíù",
  "plus-desktop-button": "üíù"
};
const easterIcons = {
  "account-link": (user) =>
    `üê£<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "ü•ö",
  "logout-link": "üö™",
  "auth-link": "üê∞",
  "smart-post": "üå∏<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "üê•<span>–í—ñ–¥–µ–æ</span>",
  "post": "üå∏<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "üê•<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üß∫",
  "plus-desktop-button": "üß∫"
};
const vyshyvankaIcons = {
  "account-link": (user) =>
    `üßµ<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "ü™°",
  "logout-link": "üö™",
  "auth-link": "üß∂",
  "smart-post": "ü™¢<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "üìΩÔ∏è<span>–í—ñ–¥–µ–æ</span>",
  "post": "ü™¢<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "üìΩÔ∏è<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üßø",
  "plus-desktop-button": "üßø"
};
const independenceIcons = {
  "account-link": (user) =>
    `üá∫üá¶<span class="icon-text">${user.name} ${user.supername}</span>`,
  "register-link": "üíôüíõ",
  "logout-link": "üö™",
  "auth-link": "üïäÔ∏è",
  "smart-post": "üìù<span>–î–æ–ø–∏—Å–∏</span>",
  "smart-video": "üìπ<span>–í—ñ–¥–µ–æ</span>",
  "post": "üìù<span>–î–æ–ø–∏—Å–∏</span>",
  "video": "üìπ<span>–í—ñ–¥–µ–æ</span>",
  "plus-button": "üåæ",
  "plus-desktop-button": "üåæ"
};
function applyIcons(set, user = null) {
  for (const [id, icon] of Object.entries(set)) {
    const el = document.getElementById(id);
    if (!el) continue;

    if (!el.dataset.originalHtml) {
      el.dataset.originalHtml = el.innerHTML;
    }

    el.querySelectorAll("i.material-icons, .material-icons").forEach(i => i.remove());

    if (typeof icon === "function") {
      if (!user) continue;
      el.innerHTML = icon(user);
      continue;
    }

    el.innerHTML = icon;
  }
}

function restoreIcons() {
  document.querySelectorAll("[data-original-html]").forEach(el => {
    el.innerHTML = el.dataset.originalHtml;
  });
}

/* ================================
   üé® BUTTON COLORS
   ================================ */
function styleButtons(bg, color) {
  document.querySelectorAll("button, .btn").forEach(btn => {
    btn.dataset.originalBg = btn.style.backgroundColor;
    btn.dataset.originalColor = btn.style.color;
    btn.style.backgroundColor = bg;
    btn.style.color = color;
  });
}

function resetButtonColors() {
  document.querySelectorAll("button, .btn").forEach(btn => {
    if (btn.dataset.originalBg) btn.style.backgroundColor = btn.dataset.originalBg;
    if (btn.dataset.originalColor) btn.style.color = btn.dataset.originalColor;
  });
}
</script>
  <script>
          let deferredPrompt;
const installBtn = document.getElementById('installBtn');

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();  // –ó–∞–±–∏—Ä–∞—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –±–∞–Ω–µ—Ä
  deferredPrompt = e;   // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –ø–æ–¥—ñ—é –¥–ª—è –≤–∏–∫–ª–∏–∫—É –ø—ñ–∑–Ω—ñ—à–µ
  installBtn.style.display = 'flex'; // –ü–æ–∫–∞–∑—É—î–º–æ –∫–Ω–æ–ø–∫—É
});

installBtn.addEventListener('click', async () => {
  installBtn.style.display = 'none'; // –•–æ–≤–∞—î–º–æ –∫–Ω–æ–ø–∫—É –ø—ñ—Å–ª—è –∫–ª—ñ–∫—É
  if (deferredPrompt) {
    deferredPrompt.prompt();          // –ü–æ–∫–∞–∑—É—î–º–æ —Å–∏—Å—Ç–µ–º–Ω–∏–π –¥—ñ–∞–ª–æ–≥ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è
    const choiceResult = await deferredPrompt.userChoice;
    deferredPrompt = null;
    console.log('–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è: ', choiceResult.outcome);
  }
});
function showRulesModal() {
  const modal = document.getElementById("rules-update-modal");
  const lastAccepted = localStorage.getItem("rules_version");
  const currentVersion = "2025-10";

  if (lastAccepted !== currentVersion) {
    modal.style.display = "flex";
  }
}

function acceptRulesUpdate() {
  localStorage.setItem("rules_version", "2025-10");
  document.getElementById("rules-update-modal").style.display = "none";
}

window.addEventListener("load", showRulesModal);
  </script>

    <script>
function toggleSidebar() {
    var sidebar = document.querySelector('.menu');
    var content = document.querySelector('.content');

    if (sidebar.style.width === "240px") {
        sidebar.style.width = "0";
        content.style.marginLeft = "0";
    } else {
        sidebar.style.width = "240px";
        content.style.marginLeft = "240px";
    }
}

// –ó–∞–∫—Ä–∏—Ç—Ç—è –º–µ–Ω—é
function closeSidebar() {
    var sidebar = document.querySelector('.menu');
    var content = document.querySelector('.content');

    sidebar.style.width = "0";
    content.style.marginLeft = "0";
}

let currentEditKey = null;
let maxTimeInMinutes = null;
let timeLeftInSeconds = null;
let sleepStart = null;
let sleepEnd = null;
let userAge = null;
 // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ —á–∞—Å –≤ —Å–µ–∫—É–Ω–¥–∏
    let currentUserEmail = null;
    let showNSFW = false; // Track whether the user wants to view NSFW content

firebase.initializeApp({
  apiKey: "AIzaSyBkPYP3bnDy61NFjRSboRZrfTVNTdIMWbY",
  authDomain: "videovortex-235cd.firebaseapp.com",
  databaseURL: "https://videovortex-235cd-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "videovortex-235cd",
  storageBucket: "videovortex-235cd.appspot.com",
  messagingSenderId: "681594250269",
  appId: "1:681594250269:web:1176b21fcc8fe2a7d052f4"
});
const auth = firebase.auth();
const database = firebase.database();
const storage = firebase.storage();
const messaging = firebase.messaging();

// ==========================
// –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è Service Worker
// ==========================
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/firebase-messaging-sw.js')
    .then(registration => {
      console.log('‚úÖ Service Worker –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ', registration);
      messaging.useServiceWorker(registration);
    })
    .catch(err => console.error('‚ùå –ü–æ–º–∏–ª–∫–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó SW:', err));
}

// ==========================
// –ó–∞–ø–∏—Ç –¥–æ–∑–≤–æ–ª—É –Ω–∞ –ø—É—à—ñ
// ==========================
async function enablePushNotifications(userId) {
  try {
    const permission = await Notification.requestPermission();
    if (permission !== "granted") {
      console.log("‚ùå –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –¥–æ–∑–≤–æ–ª–∏–≤ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è");
      return;
    }

    const token = await messaging.getToken({
      vapidKey: "BFkinse0q7x94PIX608Y9QsATJ0Ht2S-k6TeOpSFdB0sXIRLyxf1wKHTboOUHJY5tQB8wGMyMcoEQEV5fDu4sS4"
    });

    console.log("‚úÖ Push —Ç–æ–∫–µ–Ω:", token);

    // –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞ —É Firebase
    database.ref("users/" + userId + "/pushToken").set(token);

  } catch (err) {
    console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–æ–∫–µ–Ω–∞:", err);
  }
}

// ==========================
// –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ–ª–∏ —Å–∞–π—Ç –≤—ñ–¥–∫—Ä–∏—Ç–∏–π
// ==========================
messaging.onMessage((payload) => {
  console.log("üì¨ –ù–æ–≤–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:", payload);
  const { title, body,  } = payload.notification;
  new Notification(title, { body,  });
});

         document.getElementById("auth-link").onclick = function() {
            const authForm = document.getElementById("auth-form");
            authForm.style.display = authForm.style.display === "none" ? "block" : "none";
            document.getElementById("register-form").style.display = "none";
        };

        document.getElementById("register-link").onclick = function() {
            const registerForm = document.getElementById("register-form");
            registerForm.style.display = registerForm.style.display === "none" ? "block" : "none";
            document.getElementById("auth-form").style.display = "none";
        };


        document.getElementById("post").onclick = function() {
           document.getElementById("video-container").style.display = 'none';
        document.getElementById("photo-container").style.display = 'flex';
        }
            document.getElementById("video").onclick = function() {
           document.getElementById("video-container").style.display = 'flex';
        document.getElementById("photo-container").style.display = 'none';
        }
        document.getElementById("smart-post").onclick = function() {
           document.getElementById("video-container").style.display = 'none';
           document.getElementById("smart-video").classList.remove("button-liquid-glass");
          document.getElementById("smart-post").classList.add("button-liquid-glass");
        document.getElementById("photo-container").style.display = 'flex';
        }
            document.getElementById("smart-video").onclick = function() {
              document.getElementById("smart-video").classList.add("button-liquid-glass");
              document.getElementById("smart-post").classList.remove("button-liquid-glass");
           document.getElementById("video-container").style.display = 'flex';
        document.getElementById("photo-container").style.display = 'none';
        }

            function blockScreenForVerification() {
    document.body.innerHTML = `
                <h1>–ü—ñ–¥—Ç–≤–µ—Ä–¥—å—Ç–µ –≤–∞—à—É –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω—É –ø–æ—à—Ç—É</h1>
                <p>–ú–∏ –Ω–∞–¥—ñ—Å–ª–∞–ª–∏ –≤–∞–º –ª–∏—Å—Ç –Ω–∞ –ø–æ—à—Ç—É. –ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å —Å–≤—ñ–π –∞–∫–∞—É–Ω—Ç! –Ø–∫—â–æ –Ω–µ –±–∞—á–∏—Ç–µ, —Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ø–∞–ø–∫—É "–°–ø–∞–º".</p>
                <button style="
                    margin-top: 20px;
                    padding: 10px 20px;
                    font-size: 16px;
                    border: none;
                    border-radius: 5px;
                    background: #ffffff;
                    color: #ff7e5f;
                    cursor: pointer;
                " onclick="resendVerification()">–ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ª–∏—Å—Ç —â–µ —Ä–∞–∑</button>
<button id="delete-account" onclick="deleteAccount()"><i class="material-icons">person_remove</i><span style="margin-left: 5px;">–í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</span></button>
<a href="#" id="logout-link-verification" onclick="logout()">
                <i class="material-icons">logout</i><span class="icon-text">–í–∏–π—Ç–∏</span>
</a>
                <p style="margin-top: 20px;">–ü—ñ—Å–ª—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø—Ä–æ—Å—Ç–æ –∑–∞—á–µ–∫–∞–π—Ç–µ –∞–±–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Å—Ç–æ—Ä—ñ–Ω–∫—É.</p>
            </div>
        </div>
    `;
}

// –ù–∞–¥—ñ—Å–ª–∞—Ç–∏ –ª–∏—Å—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ
function resendVerification() {
    const user = auth.currentUser;
    if (user) {
        user.sendEmailVerification()
            .then(() => {
                alert("–õ–∏—Å—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–∞–¥—ñ—Å–ª–∞–Ω–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ!");
            })
            .catch((error) => {
                alert("–ü–æ–º–∏–ª–∫–∞ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –ª–∏—Å—Ç–∞: " + error.message);
            });
    }
}

function deleteAccount() {
    const user = firebase.auth().currentUser;

    if (!user) {
        alert("–°–ø–æ—á–∞—Ç–∫—É —É–≤—ñ–π–¥—ñ—Ç—å —É —Å–≤—ñ–π –∞–∫–∞—É–Ω—Ç.");
        return;
    }

    if (!confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç? –í–∞—à—ñ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ! –¶—é –¥—ñ—é –Ω–µ –º–æ–∂–Ω–∞ —Å–∫–∞—Å—É–≤–∞—Ç–∏.")) {
        return;
    }

    const uid = user.uid;
    const videosRef = firebase.database().ref("videos");
    const commentsRef = firebase.database().ref("comments");
    const usersRef = firebase.database().ref("users/" + uid);

    // ?? 1. –í–∏–¥–∞–ª—è—î–º–æ –≤—Å—ñ –≤—ñ–¥–µ–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    videosRef.once("value")
        .then(snapshot => {
            const deleteVideoPromises = [];

            snapshot.forEach(childSnapshot => {
                const videoData = childSnapshot.val();
                const videoKey = childSnapshot.key;

                if (videoData.email === user.email) {
                    const dbDelete = firebase.database().ref(`videos/${videoKey}`).remove();
                    const storageDelete = firebase.storage().ref(`videos/${videoKey}`).delete()
                        .catch(error => console.warn(`?? –ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–¥–∞–ª–∏—Ç–∏ —Ñ–∞–π–ª –∑ Storage (${videoKey}):`, error));

                    deleteVideoPromises.push(dbDelete, storageDelete);
                }
            });

            return Promise.all(deleteVideoPromises);
        })
        // ?? 2. –û–Ω–æ–≤–ª—é—î–º–æ –≤—Å—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        .then(() => commentsRef.once("value"))
        .then(snapshot => {
            const updatePromises = [];

            snapshot.forEach(childSnapshot => {
                const commentData = childSnapshot.val();
                const commentKey = childSnapshot.key;

                // –Ø–∫—â–æ –∫–æ–º–µ–Ω—Ç–∞—Ä –Ω–∞–ª–µ–∂–∏—Ç—å –ø–æ—Ç–æ—á–Ω–æ–º—É –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
                if (commentData.email === user.email) {
                    const update = commentsRef.child(commentKey).update({
                        email: "–í–∏–¥–∞–ª–µ–Ω–∏–π –∞–∫–∞—É–Ω—Ç",
                        commentAuthor: "–í–∏–¥–∞–ª–µ–Ω–∏–π –∞–∫–∞—É–Ω—Ç"
                    });
                    updatePromises.push(update);
                }
            });

            return Promise.all(updatePromises);
        })
        // ?? 3. –í–∏–¥–∞–ª—è—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
        .then(() => usersRef.remove())
        // ?? 4. –í–∏–¥–∞–ª—è—î–º–æ —Å–∞–º –∞–∫–∞—É–Ω—Ç
        .then(() => user.delete())
        // ?? 5. –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
        .then(() => {
            alert("? –ê–∫–∞—É–Ω—Ç —ñ –≤—Å—ñ –ø–æ–≤‚Äô—è–∑–∞–Ω—ñ –¥–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.");
            location.reload();
        })
        .catch(error => {
            if (error.code === 'auth/requires-recent-login') {
                alert("–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å –∑–Ω–æ–≤—É –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –∞–∫–∞—É–Ω—Ç—É.");
                firebase.auth().signOut();
            } else {
                console.error("? –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –∞–∫–∞—É–Ω—Ç—É:", error);
                alert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –∞–∫–∞—É–Ω—Ç—É: " + error.message);
            }
        });
}




    document.getElementById("show-nsfw-videos").addEventListener("change", function() {
if (auth.currentUser) {
        showNSFW = this.checked;  // Update the variable based on the checkbox state
        loadVideos();  // Reload the videos with the updated setting
} else {
alert("–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —É–≤—ñ–º–∫–Ω–µ–Ω–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—è —è–∫ NSFW.");
}
    });
    async function isUserBlockedByMe(targetUid) {
  const me = firebase.auth().currentUser;
  if (!me || !targetUid) return false;

  const snap = await database.ref(`users/${me.uid}/blockedUsers/${targetUid}`).once("value");
  return snap.exists();
}

async function didUserBlockMe(targetUid) {
  const me = firebase.auth().currentUser;
  if (!me || !targetUid) return false;

  const snap = await database.ref(`users/${targetUid}/blockedUsers/${me.uid}`).once("value");
  return snap.exists();
}
    function enableBanduraUI(role) {
    const banduraBlock = document.getElementById("bandura-options");
    if (!banduraBlock) return;

    if (role === "bandura" || role === "moderator") {
        banduraBlock.style.display = "block";
    } else {
        banduraBlock.style.display = "none";
    }
}
document.getElementById("domain-restrict-checkbox").onclick = function(event) {
    if (!currentUserEmail || !currentUserEmail.endsWith("@kfccte-nau.ukr.education")) {
        alert('–°—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞');
        event.preventDefault(); // Prevents checkbox from being checked
    }
}
function sanitizeHTML(str) {
    const div = document.createElement("div");
    div.innerText = str;
    return div.innerHTML;
}

function getSafeBanduraHTML(banduraExtra) {
    if (!banduraExtra) return "";
    const s = str => str ? sanitizeHTML(str) : "";

    let html = `<span style="color:#ffd700;">üéµ –ë–∞–Ω–¥—É—Ä–∞</span>`;
    html += `<span style="opacity:0.7;"> (${s(banduraExtra.style)}, ${s(banduraExtra.difficulty)})</span>`;

    if (banduraExtra.tempo) html += `<br>–¢–µ–º–ø: ${s(banduraExtra.tempo.toString())} BPM`;
    if (banduraExtra.event) html += `<br>–ü–æ–¥—ñ—è: ${s(banduraExtra.event)}`;
    if (banduraExtra.year) html += `<br>–†—ñ–∫: ${s(banduraExtra.year.toString())}`;
    if (banduraExtra.performer) html += `<br>–í–∏–∫–æ–Ω–∞–≤–µ—Ü—å: ${s(banduraExtra.performer)}`;
    if (banduraExtra.tags) html += `<br>–¢–µ–≥–∏: ${s(banduraExtra.tags)}`;
    if (banduraExtra.markers) html += `<br>–ú–∞—Ä–∫–µ—Ä–∏: ${s(banduraExtra.markers)}`;

    return html;
}
function getInitials(name) {
  if (!name) return "?";
  const parts = name.trim().split(" ");
  if (parts.length === 1) return parts[0][0].toUpperCase();
  return (parts[0][0] + parts[1][0]).toUpperCase();
}
function stringToColor(str) {
  let hash = 0;
  for (let i = 0; i < str.length; i++) {
    hash = str.charCodeAt(i) + ((hash << 5) - hash);
  }
  return `hsl(${hash % 360}, 65%, 55%)`;
}
function loadVideos() {
    const videoGallery = document.getElementById("video-gallery");
    if (!videoGallery) return;
    videoGallery.innerHTML = "";

    const showNSFWGlobal = showNSFW;

    // üîπ –°–ª—É—Ö–∞—î–º–æ –Ω–æ–≤—ñ –≤—ñ–¥–µ–æ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
    database.ref("videos").on("child_added", snapshot => {
        const videoData = snapshot.val();
        const videoKey = snapshot.key;

        // üîπ 1. –§—ñ–ª—å—Ç—Ä–∏
        if (videoData.nsfw && !showNSFWGlobal) return;
          if (firebase.auth().currentUser && video.authorUid) {
    const iBlocked = isUserBlockedByMe(video.authorUid);
    const heBlockedMe = didUserBlockMe(video.authorUid);

    if (iBlocked || heBlockedMe) {
      return;
    }
  }
        if (videoData.private && videoData.email !== currentUserEmail) return;
        if (videoData.domainRestrict && (!currentUserEmail || !currentUserEmail.endsWith("@kfccte-nau.ukr.education"))) return;

        // üîπ 2. –í—ñ–¥–µ–æ –µ–ª–µ–º–µ–Ω—Ç
        const videoElement = document.createElement("video");
        videoElement.classList.add("video-item");
        videoElement.controls = false;
        videoElement.preload = "metadata";
        videoElement.playsInline = true;

        const source = document.createElement("source");
        source.src = videoData.url;
        source.type = "video/mp4";
        videoElement.appendChild(source);

        videoElement.addEventListener("loadedmetadata", () => {
            if (videoElement.videoWidth === 0 || videoElement.videoHeight === 0) {
                const audio = document.createElement("audio");
                audio.controls = true;
                audio.src = videoData.url;
                audio.className = "audio-item";
                audio.style.width = "100%";
                videoElement.replaceWith(audio);
            }
        });

        videoElement.dataset.title = videoData.title || "";  
        videoElement.dataset.description = videoData.description || "";  
        videoElement.dataset.author = videoData.author || "";

        // üîπ 3. –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ
        const commentSection = document.createElement("div");
        commentSection.classList.add("video-comment");

        if (videoData.disabledComments === true) {
            commentSection.innerHTML = `üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –≤–∏–º–∫–Ω–µ–Ω—ñ –¥–ª—è —Ü—å–æ–≥–æ –≤—ñ–¥–µ–æ.`;
        } else {
            commentSection.innerHTML = `
                <h3 style="color: white; text-align: left;">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ:</h3>
                <div id="comments-${videoKey}" class="comments">–©–µ –Ω–µ–º–∞—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤...</div>
                <input class="comment-liquid-glass" type="text" id="comment-input-${videoKey}" placeholder="–í–∞—à –∫–æ–º–µ–Ω—Ç–∞—Ä">
                <button class="comment-button" onclick="uploadComment('${videoKey}', '${videoData.email}')">
                    <i class="material-icons">send</i>
                </button>
                <div class="comment-section" id="comment-section-${videoKey}">
                    <button id="random-comments-${videoKey}" onclick="insertRandomComment('${videoKey}')">üîÅ –í—Å—Ç–∞–≤–∏—Ç–∏ –≤–∏–ø–∞–¥–∫–æ–≤–∏–π —Ç–µ–∫—Å—Ç</button>
                    <label id="private-checkbox-${videoKey}" style="display: none;">
                        <input type="checkbox" id="private-comment-${videoKey}">
                        –ü—Ä–∏–≤–∞—Ç–Ω–∏–π
                    </label>
                </div>
            `;
        }

        // üîπ 4. –ö–ª—ñ–∫ –ø–æ –≤—ñ–¥–µ–æ
        videoElement.onclick = () => {
            const viewedKey = `viewed_${videoKey}`;
            if (!localStorage.getItem(viewedKey)) {
                const newViewCount = (videoData.views || 0) + 1;
                database.ref("videos/" + videoKey).update({ views: newViewCount })
                    .then(() => localStorage.setItem(viewedKey, true))
                    .catch(console.error);
            }

            const videoParams = new URLSearchParams({
                key: videoKey,
                url: videoData.url,
                title: videoData.title,
                author: videoData.author,
                publishDate: videoData.publishDate,
                description: videoData.description || "–ë–µ–∑ –æ–ø–∏—Å—É",
                views: videoData.views || 0,
                avatar: videoData.author ? videoData.author.charAt(0).toUpperCase() : "?"
            });
            window.location.href = `video-beta.html?${videoParams.toString()}`;
        };

        // üîπ 5. –ü—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ
        const privateComment = commentSection.querySelector(`#private-checkbox-${videoKey}`);
        const privateCheckbox = commentSection.querySelector(`#private-comment-${videoKey}`);
        if (privateComment && privateCheckbox) {
            const showPrivate = userAge >= 16;
            privateComment.style.display = showPrivate ? "block" : "none";
            privateCheckbox.disabled = !showPrivate;
        }

        // üîπ 6. –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –≤—ñ–¥–µ–æ
        const infoElement = document.createElement("div");
        infoElement.classList.add("video-info");

        const avatar = document.createElement("div");
        avatar.className = "avatar";
        avatar.title = videoData.author || "–ê–Ω–æ–Ω—ñ–º";

        if (videoData.authorAvatar) {
            firebase.storage().ref(`avatars/${videoData.authorAvatar}.webp`).getDownloadURL()
                .then(url => {
                    avatar.style.backgroundImage = `url(${url})`;
                    avatar.classList.add("avatar-image");
                });
        } else {
            avatar.innerText = getInitials(videoData.author);
            avatar.style.backgroundColor = stringToColor(videoData.author || "?");
        }

        avatar.onclick = () => {
            const infoParams = new URLSearchParams({
                avatar: videoData.author ? videoData.author.charAt(0).toUpperCase() : "?",
                author: videoData.author
            });
            window.location.href = `profile-beta.html?${infoParams.toString()}`;
        };

        const detailsElement = document.createElement("div");
        detailsElement.classList.add("video-details");
        let statusBadge = "";


        detailsElement.innerHTML = `
            ${sanitizeHTML(videoData.title || "–ë–µ–∑ –Ω–∞–∑–≤–∏")}
            ${videoData.private ? "<span style='color: orange;'>üîí –ü—Ä–∏–≤–∞—Ç–Ω–µ</span>" : ""}
               ${statusBadge ? `<div class="video-status">${statusBadge}</div>` : ""}
            ${videoData.nsfw ? "<span style='color: red;'>NSFW</span>" : ""}
            <br>–ê–≤—Ç–æ—Ä: ${sanitizeHTML(videoData.author || "–ê–Ω–æ–Ω—ñ–º")}<br>
            –ü–µ—Ä–µ–≥–ª—è–¥—ñ–≤: ${videoData.views || 0}<br>
            –î–∞—Ç–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó: ${videoData.publishDate || "–ù–µ –≤–∫–∞–∑–∞–Ω–∞"}
        `;

        // üîπ 7. –ú–µ–Ω—é –¥—ñ–π
        const moreBtn = document.createElement("button");
        moreBtn.classList.add("more-btn");
        moreBtn.innerHTML = `<i class="material-icons">more_vert</i>`;

        const actionMenu = document.createElement("div");
        actionMenu.classList.add("action-menu");
        actionMenu.style.display = "none";

        if (currentUserEmail === videoData.email || currentUserEmail === "zhuzhun2008@gmail.com") {
            const deleteButton = document.createElement("button");
            deleteButton.innerHTML = `<a style="padding:3px 8px; display:flex; border-radius: 50%; align-items:center; justify-content:center;">
                <i class="material-icons">delete</i>–í–∏–¥–∞–ª–∏—Ç–∏</a>`;
            deleteButton.onclick = () => deleteVideo(videoKey, videoData.url);
            deleteButton.addEventListener("click", () => actionMenu.style.display = "none");
            actionMenu.appendChild(deleteButton);
        }

        if (currentUserEmail === videoData.email) {
            const editButton = document.createElement("button");
            editButton.innerHTML = `<a style="padding:3px 8px; display:flex; align-items:center; justify-content:center;">
                <i class="material-icons">edit</i>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>`;
            editButton.onclick = () => editVideo(videoKey, videoData);
            editButton.addEventListener("click", () => actionMenu.style.display = "none");
            actionMenu.appendChild(editButton);
        }

        moreBtn.addEventListener("click", () => {
            actionMenu.style.display = (actionMenu.style.display === "block") ? "none" : "block";
        });

        infoElement.appendChild(avatar);
        infoElement.appendChild(detailsElement);
        infoElement.appendChild(moreBtn);
        infoElement.appendChild(actionMenu);

        // üîπ 8. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤—ñ–¥–µ–æ
        const container = document.createElement("div");
        container.classList.add("video-container");
        container.dataset.id = videoKey; // –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É
        container.appendChild(infoElement);
        container.appendChild(commentSection);
        container.appendChild(videoElement);

        videoGallery.appendChild(container);

        // üîπ 9. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤
        loadComments(videoKey, videoData.email);
    });
}
const randomComments = [
  "–ö–ª–∞—Å–Ω–µ –≤—ñ–¥–µ–æ! üé¨üëç",
  "–î—É–∂–µ —Ü—ñ–∫–∞–≤–æ ü§ì‚ú®",
  "–î—è–∫—É—é –∑–∞ –∫–æ–Ω—Ç–µ–Ω—Ç üôèüíñ",
  "–°—É–ø–µ—Ä –ø–æ—è—Å–Ω–µ–Ω–Ω—è!üëåüìö",
  "–ü—ñ–¥—Ç—Ä–∏–º—É—é üí™üî•",
  "–¢–æ–ø—á–∏–∫!‚≠êüòé"
];
function formatTime(seconds) {
    seconds = Math.floor(seconds); // –æ–∫—Ä—É–≥–ª—é—î–º–æ –¥–æ —Ü—ñ–ª–æ–≥–æ —á–∏—Å–ª–∞
    const h = Math.floor(seconds / 3600); // –≥–æ–¥–∏–Ω–∏
    const m = Math.floor((seconds % 3600) / 60); // —Ö–≤–∏–ª–∏–Ω–∏
    const s = seconds % 60; // —Å–µ–∫—É–Ω–¥–∏

    const mm = m.toString().padStart(2, "0");
    const ss = s.toString().padStart(2, "0");

    if (h > 0) {
        const hh = h.toString().padStart(2, "0");
        return `${hh}:${mm}:${ss}`;
    } else {
        return `${mm}:${ss}`;
    }
}
function insertRandomComment(videoKey) {
  const inputId = `comment-input-${videoKey}`;
  const input = document.getElementById(inputId);

  if (input) {
    const randomIndex = Math.floor(Math.random() * randomComments.length);
    input.value = randomComments[randomIndex];
  }
}
function deleteVideo(videoKey, videoURL) {
    if (!videoURL || !videoKey) return alert("–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è –≤—ñ–¥–µ–æ");

    if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ –≤—ñ–¥–µ–æ?")) {
        const storageRef = storage.refFromURL(videoURL);
        storageRef.delete()
        .then(() => {
            return database.ref(`videos/${videoKey}`).remove();
        })
        .then(() => {
            alert("–í—ñ–¥–µ–æ —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.");
            loadVideos();
        })
        .catch((error) => {
            console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –≤—ñ–¥–µ–æ:", error);
            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ –≤—ñ–¥–µ–æ: " + error.message);
        });
    }
}
function createSecondChannel() {
  const name = document.getElementById("second-channel-name").value.trim();
  if (!name) return alert("–í–≤–µ–¥–∏ –Ω–∞–∑–≤—É");

  const uid = auth.currentUser.uid;

  database.ref(`users/${uid}/channels/second`).set({
    name,
    avatar: name.charAt(0).toUpperCase()
  });

  alert("–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª —Å—Ç–≤–æ—Ä–µ–Ω–æ ‚úÖ");
}
function editVideo(videoKey, videoData) {
  currentEditKey = videoKey;
  document.getElementById("edit-form").style.display = 'block';

  // –ó–∞–ø–æ–≤–Ω—é—î–º–æ –ø–æ–ª—è —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è
  document.getElementById("edit-video-title").value = videoData.title || '';
  document.getElementById("edit-video-description").value = videoData.description || '';
document.getElementById("edit-private-checkbox").checked = videoData.private || false;
}

function saveVideoChanges() {
  if (!currentEditKey) return alert("–í—ñ–¥–µ–æ –Ω–µ –≤–∏–±—Ä–∞–Ω–æ.");

  const newTitle = document.getElementById("edit-video-title").value.trim();
const newPrivate = document.getElementById("edit-private-checkbox").checked;
  const newDescription = document.getElementById("edit-video-description").value.trim();

  if (!newTitle) {
    alert("–ù–∞–∑–≤–∞ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—å–æ—é!");
    return;
  }

  // –û–Ω–æ–≤–ª—é—î–º–æ —Ç—ñ–ª—å–∫–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ —ñ –æ–ø–∏—Å
  database.ref("videos/" + currentEditKey).update({
    title: newTitle,
    description: newDescription,
    private: newPrivate
  }).then(() => {
    alert("? –í—ñ–¥–µ–æ –æ–Ω–æ–≤–ª–µ–Ω–æ!");
    document.getElementById("edit-form").style.display = 'none';
    currentEditKey = null;
    loadVideos(); // –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É
  }).catch(error => {
    alert("? –ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ –≤—ñ–¥–µ–æ: " + error.message);
  });
}
function loadChannelSelect() {
    const select = document.getElementById("video-channel-select");
    if (!select) return;

    const user = firebase.auth().currentUser;
    if (!user) return;

    const uid = user.uid;
    select.innerHTML = "";

    database.ref(`users/${uid}`).once("value").then(snapshot => {
        const userData = snapshot.val();
        if (!userData) return;

        // üîπ –û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª
        const mainName = `${userData.name || ""} ${userData.supername || ""}`.trim();

        const mainOption = document.createElement("option");
        mainOption.value = "main";
        mainOption.textContent = mainName || "–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª";
        mainOption.dataset.name = mainName;
        mainOption.dataset.avatar = userData.avatar || "";
        select.appendChild(mainOption);

        // üîπ –î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª
        if (userData.channels && userData.channels.second) {
            const second = userData.channels.second;

            const secondOption = document.createElement("option");
            secondOption.value = "second";
            secondOption.textContent = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.name = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.avatar = second.avatar || "";
            select.appendChild(secondOption);
        }
    });
}
function getActiveChannelData() {
    const select = document.getElementById("video-channel-select");
    if (!select) return null;

    const option = select.options[select.selectedIndex];
    if (!option) return null;

    return {
        key: option.value,       // main | second
        name: option.dataset.name,
        avatar: option.dataset.avatar || ""
    };
}
function generateDescription() {
    const title = document.getElementById("video-title").value;

    if (!title) return alert("–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –≤—ñ–¥–µ–æ");

    const functions = firebase.app().functions("europe-west1");
    const fn = functions.httpsCallable("generateDescription");

    fn({ title })
        .then(res => {
            document.getElementById("video-description").value = res.data.description;
        })
        .catch(err => console.error("AI error:", err));
}
async function convertToMp4(file, onStatus) {
  if (!window.ffmpeg.loaded) {
    onStatus?.("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ-–¥–≤–∏–∂–∫–∞‚Ä¶");
    await window.ffmpeg.load(); // –ë–ï–ó coreURL —Ç—É—Ç
  }

  onStatus?.("–ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ñ–∞–π–ª—É‚Ä¶");
  const data = await window.fetchFile(file);
  window.ffmpeg.FS("writeFile", "input.mp4", data);

  onStatus?.("–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è —É MP4 (H.264)‚Ä¶");
  await window.ffmpeg.run(
    "-i", "input.mp4",
    "-c:v", "libx264",
    "-preset", "veryfast",
    "-pix_fmt", "yuv420p",
    "-movflags", "faststart",
    "-c:a", "aac",
    "-b:a", "128k",
    "output.mp4"
  );

  const out = window.ffmpeg.FS("readFile", "output.mp4");
  return new File([out.buffer], "converted.mp4", { type: "video/mp4" });
}
document.getElementById("video-file").addEventListener("change", async (e) => {
  const file = e.target.files[0];
  if (!file) return;

  // —è–∫—â–æ –≤–∂–µ mp4 ‚Äî –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏–º–æ
  if (file.type === "video/mp4") return;

  const statusEl = document.getElementById("progress-text");
  document.getElementById("progress-container").style.display = "block";

  try {
    const converted = await convertToMp4(file, (status) => {
      statusEl.innerText = status;
    });

    // üîÅ –ü–Ü–î–ú–Ü–ù–ê –§–ê–ô–õ–£ –í INPUT
    const dt = new DataTransfer();
    dt.items.add(converted);
    e.target.files = dt.files;

    statusEl.innerText = "–ì–æ—Ç–æ–≤–æ –¥–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è ‚úî";
  } catch (err) {
    console.error("‚ùå –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è –Ω–µ –≤–¥–∞–ª–∞—Å—è:", err);
    alert("–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó –≤—ñ–¥–µ–æ");
  }
});

function uploadVideo() {
  const startTime = Date.now();
  const isBandura = document.getElementById("bandura-video")?.checked || false;

  const banduraExtra = isBandura ? {
    style: document.getElementById("bandura-style").value || "–°–æ–ª–æ",
    key: document.getElementById("bandura-key").value || "",
    difficulty: document.getElementById("bandura-difficulty").value || "–ü–æ—á–∞—Ç–∫–æ–≤–∏–π",
    tempo: document.getElementById("bandura-tempo").value || "",
    slowMode: document.getElementById("bandura-slow").checked,
    event: document.getElementById("bandura-event").value || "",
    year: document.getElementById("bandura-year").value || "",
    performer: document.getElementById("bandura-performer").value || "",
    tags: document.getElementById("bandura-tags").value || "",
    markers: document.getElementById("bandura-markers").value || ""
  } : null;

  const videoTitle = document.getElementById("video-title").value;
  const videoDescription = document.getElementById("video-description").value;
  const videoFile = document.getElementById("video-file").files[0];
  const isNSFW = document.getElementById("nsfw-checkbox").checked;
  const disabledComments = document.getElementById("disabled-comments-checkbox").checked;
  const privateVideo = document.getElementById("private-checkbox").checked;
  const domainRestrict = document.getElementById("domain-restrict-checkbox")?.checked || false;

  if (!videoTitle || !videoFile) {
    alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è!");
    return;
  }

  const user = firebase.auth().currentUser;
  if (!user) {
    alert("–ü–æ—Ç—Ä—ñ–±–Ω–æ —É–≤—ñ–π—Ç–∏ –≤ –∞–∫–∞—É–Ω—Ç");
    return;
  }

  const uid = user.uid;

  database.ref("users/" + uid).once("value").then(snapshot => {
    const userData = snapshot.val() || {};

    const authorName = `${userData.name || ""} ${userData.supername || ""}`.trim();
    const authorAvatar = userData.avatarUrl || null; // ‚úÖ URL –∞–≤–∞—Ç–∞—Ä–∞

    const storageRef = storage.ref(`videos/${Date.now()}_${videoFile.name}`);
    const uploadTask = storageRef.put(videoFile);

    // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —Å—Ç–∞–Ω —É localStorage
    localStorage.setItem("activeUpload", JSON.stringify({
      fileName: videoFile.name,
      fileSize: videoFile.size,
      bytesTransferred: 0,
      startedAt: Date.now(),
      status: "uploading"
    }));

    uploadTask.on("state_changed",
      snapshot => {
        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;

        const uploadData = JSON.parse(localStorage.getItem("activeUpload"));
        if (uploadData) {
          uploadData.bytesTransferred = snapshot.bytesTransferred;
          localStorage.setItem("activeUpload", JSON.stringify(uploadData));
        }

        const timeElapsed = (Date.now() - startTime) / 1000;
        const speed = snapshot.bytesTransferred / Math.max(timeElapsed, 1);
        const remainingBytes = snapshot.totalBytes - snapshot.bytesTransferred;
        const timeLeft = remainingBytes / Math.max(speed, 1);

        document.getElementById("time-left").innerText = `${Math.round(timeLeft)}s`;
        document.getElementById("upload-progress").value = progress;
        document.getElementById("progress-text").innerText = `–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: ${Math.round(progress)}%`;
        document.getElementById("progress-container").style.display = "block";
      },
      error => {
        console.error(error);
        alert("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ.");
      },
      () => {
        const uploadData = JSON.parse(localStorage.getItem("activeUpload"));
        if (uploadData) {
          uploadData.status = "processing";
          localStorage.setItem("activeUpload", JSON.stringify(uploadData));
        }

        uploadTask.snapshot.ref.getDownloadURL().then(downloadURL => {
          const currentDate = new Date().toLocaleDateString();

          database.ref("videos").push({
            title: videoTitle,
            author: authorName || "–ê–Ω–æ–Ω—ñ–º",
            authorAvatar: authorAvatar, // ‚úÖ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –∞–≤–∞—Ç–∞—Ä
            email: user.email,
            disabledComments: disabledComments,
            url: downloadURL,
            description: videoDescription,
            views: 0,
            private: privateVideo,
            domainRestrict: domainRestrict,
            nsfw: isNSFW,
            publishDate: currentDate,
            banduraExtra
          }).then(() => {
            localStorage.removeItem("activeUpload");
            alert("–í—ñ–¥–µ–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!");
            loadVideos();
            document.getElementById("upload-form").reset();
            document.getElementById("progress-container").style.display = "none";
          });
        });
      }
    );
  }).catch(err => {
    console.error("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:", err);
    alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ –ø—Ä–æ—Ñ—ñ–ª—é.");
  });
}


// –ì–µ–Ω–µ—Ä—É—î–º–æ –∞–±–æ –æ—Ç—Ä–∏–º—É—î–º–æ –∫–ª—é—á –¥–ª—è –≤—ñ–¥–µ–æ
function getVideoKey(videoKey) {
    let key = localStorage.getItem(`videoKey-${videoKey}`);
    if (!key) {
        key = crypto.randomUUID(); // –ø—Ä–æ—Å—Ç–∏–π –∫–ª—é—á, –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ —Å–∏–ª—å–Ω—ñ—à–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
        localStorage.setItem(`videoKey-${videoKey}`, key);
    }
    return key;
}

// –ü—Ä–æ—Å—Ç–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è/–¥–µ—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ AES)
async function encryptText(text, key) {
    const enc = new TextEncoder();
    const encoded = enc.encode(text + key); // –¥—É–∂–µ –±–∞–∑–æ–≤–æ
    return btoa(String.fromCharCode(...encoded));
}

async function decryptText(cipher, key) {
    const decoded = atob(cipher);
    const arr = Uint8Array.from(decoded, c => c.charCodeAt(0));
    const dec = new TextDecoder();
    const text = dec.decode(arr);
    return text.replace(key, ''); // –≤—ñ–¥–Ω—ñ–º–∞—î–º–æ –∫–ª—é—á
}
async function loadComments(videoKey, videoOwnerEmail) { 
    const commentsContainer = document.getElementById(`comments-${videoKey}`);
    commentsContainer.innerHTML = "";

    const snapshot = await database.ref("comments")
        .orderByChild("videoKey")
        .equalTo(videoKey)
        .once("value");

    if (!snapshot.exists()) {
        commentsContainer.textContent = "–©–µ –Ω–µ–º–∞—î –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤...";
        return;
    }

    const videoKeyLocal = getVideoKey(videoKey);
    const commentsArray = [];

    snapshot.forEach(childSnapshot => {
        commentsArray.push(childSnapshot.val());
    });

    for (const data of commentsArray) {
        if (data.isPrivate && !(data.email === currentUserEmail || videoOwnerEmail === currentUserEmail)) {
            continue; // –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –ø—Ä–∏–≤–∞—Ç–Ω—ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ, —è–∫—â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–µ –∞–≤—Ç–æ—Ä –∞–±–æ –≤–ª–∞—Å–Ω–∏–∫ –≤—ñ–¥–µ–æ
        }

        const commentDiv = document.createElement("div");
        commentDiv.className = "comments";
const avatarComment = document.createElement("div");
avatarComment.className = "avatar";
avatarComment.title = data.commentAuthor;

if (data.commentAuthor == "–í–∏–¥–∞–ª–µ–Ω–∏–π –∞–∫–∞—É–Ω—Ç") {
 avatarComment.textContent = "üëª";
} else {
  avatarComment.textContent = getInitials(data.commentAuthor);
}
        const userEl = document.createElement("strong");
        userEl.textContent = data.commentAuthor || "–í–∏–¥–∞–ª–µ–Ω–∏–π –∞–∫–∞—É–Ω—Ç";

        const textEl = document.createElement("span");
        if (data.isPrivate) {
            textEl.textContent = ": " + await decryptText(data.comment, videoKeyLocal);
        } else {
            textEl.textContent = ": " + data.comment;
        }

        const br = document.createElement("br");
        const dateEl = document.createElement("small");
        dateEl.textContent = data.publishDate;

        commentDiv.appendChild(avatarComment);
        commentDiv.appendChild(userEl);
        commentDiv.appendChild(textEl);
        commentDiv.appendChild(br);
        commentDiv.appendChild(dateEl);
        commentsContainer.appendChild(commentDiv);
    }
}
// –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —ñ–º–µ–Ω—ñ
function editName() {
  document.getElementById("form-edit-name").style.display = "block";
  document.getElementById("name").style.display = "none";
  document.getElementById("button-name").style.display = "none";

  const currentName = document.getElementById("name").textContent.replace("–Ü–º'—è: ", "");
  document.getElementById("edit-name").value = currentName;
}

// –í—ñ–¥–∫—Ä–∏—Ç–∏ —Ñ–æ—Ä–º—É —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä—ñ–∑–≤–∏—â–∞
function editSuperName() {
  document.getElementById("form-edit-supername").style.display = "block";
  document.getElementById("supername").style.display = "none";
  document.getElementById("button-supername").style.display = "none";

  const currentSuperName = document.getElementById("supername").textContent.replace("–ü—Ä—ñ–∑–≤–∏—â–µ: ", "");
  document.getElementById("edit-supername").value = currentSuperName;
}

// –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω—É —ñ–º–µ–Ω—ñ
function saveEditName() {
  const newName = document.getElementById("edit-name").value.trim();
  const user = firebase.auth().currentUser;
  if (!user) return alert("–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å.");

  const uid = user.uid;
  database.ref("users/" + uid).update({ name: newName }).then(() => {
    alert("? –Ü–º‚Äô—è –∑–º—ñ–Ω–µ–Ω–æ!");
    document.getElementById("form-edit-name").style.display = "none";
    document.getElementById("name").style.display = "block";
    document.getElementById("button-name").style.display = "block";
    document.getElementById("name").textContent = "–Ü–º'—è: " + newName;
    updateVideosAuthor();
  }).catch(err => alert("? –ü–æ–º–∏–ª–∫–∞: " + err.message));
}

// –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω—É –ø—Ä—ñ–∑–≤–∏—â–∞
function saveEditSuperName() {
  const newSuperName = document.getElementById("edit-supername").value.trim();
  const user = firebase.auth().currentUser;
  if (!user) return alert("–ë—É–¥—å –ª–∞—Å–∫–∞, —É–≤—ñ–π–¥—ñ—Ç—å.");

  const uid = user.uid;
  database.ref("users/" + uid).update({ supername: newSuperName }).then(() => {
    alert("? –ü—Ä—ñ–∑–≤–∏—â–µ –∑–º—ñ–Ω–µ–Ω–æ!");
    document.getElementById("form-edit-supername").style.display = "none";
    document.getElementById("supername").style.display = "block";
    document.getElementById("button-supername").style.display = "block";
    document.getElementById("supername").textContent = "–ü—Ä—ñ–∑–≤–∏—â–µ: " + newSuperName;
    updateVideosAuthor();
  }).catch(err => alert("? –ü–æ–º–∏–ª–∫–∞: " + err.message));
}
function loadPhotoChannelSelect() {
    const select = document.getElementById("photo-channel-select");
    if (!select) return;

    const user = firebase.auth().currentUser;
    if (!user) return;

    const uid = user.uid;
    select.innerHTML = "";

    database.ref(`users/${uid}`).once("value").then(snapshot => {
        const userData = snapshot.val();
        if (!userData) return;

        // üîπ –û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª
        const mainName = `${userData.name || ""} ${userData.supername || ""}`.trim();

        const mainOption = document.createElement("option");
        mainOption.value = "main";
        mainOption.textContent = mainName || "–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª";
        mainOption.dataset.name = mainName;
        mainOption.dataset.avatar = userData.avatar || "";
        select.appendChild(mainOption);

        // üîπ –î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª
        if (userData.channels && userData.channels.second) {
            const second = userData.channels.second;

            const secondOption = document.createElement("option");
            secondOption.value = "second";
            secondOption.textContent = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.name = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.avatar = second.avatar || "";
            select.appendChild(secondOption);
        }
    });
}
function getActivePhotoChannelData() {
    const select = document.getElementById("photo-channel-select");
    if (!select) return null;

    const option = select.options[select.selectedIndex];
    if (!option) return null;

    return {
        key: option.value,       // main | second
        name: option.dataset.name,
        avatar: option.dataset.avatar || ""
    };
}
// –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–≤—Ç–æ—Ä—ñ–≤ —É –≤—ñ–¥–µ–æ —Ç–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä—è—Ö

// –í—ñ–¥–ø—Ä–∞–≤–∫–∞ –∫–æ–º–µ–Ω—Ç–∞—Ä—è
async function uploadComment(videoKey, videoOwnerEmail) {
    const commentInput = document.getElementById(`comment-input-${videoKey}`);
    const commentText = commentInput.value.trim();
    const isPrivate = document.getElementById(`private-comment-${videoKey}`).checked;

    if (!commentText) return alert("–ö–æ–º–µ–Ω—Ç–∞—Ä –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ—Ä–æ–∂–Ω—ñ–º.");

    let commentData = commentText;
    if (isPrivate) {
        const videoKeyLocal = getVideoKey(videoKey);
        commentData = await encryptText(commentText, videoKeyLocal);
    }

    const uid = firebase.auth().currentUser.uid;

    // –ë–µ—Ä–µ–º–æ –¥–∞–Ω—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –∑ Firebase
    const snapshot = await database.ref("users/" + uid).once("value");
    const userData = snapshot.val();
    const commentAuthor = `${userData.name} ${userData.supername}`;

    // –î–æ–¥–∞—î–º–æ –∫–æ–º–µ–Ω—Ç–∞—Ä —É –±–∞–∑—É
    await database.ref("comments").push({
        comment: commentData,
        email: currentUserEmail,
        commentAuthor: commentAuthor,
        videoOwner: videoOwnerEmail,
        isPrivate: isPrivate,
        publishDate: new Date().toLocaleDateString(),
        videoKey: videoKey
    });

    // –û—á–∏—â—É—î–º–æ –ø–æ–ª–µ —Ç–∞ –æ–Ω–æ–≤–ª—é—î–º–æ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ
    commentInput.value = "";
    await loadComments(videoKey, videoOwnerEmail);
}


function toggleUploadVisibility() {
    const isMobile = window.innerWidth <= 968;
    const upload = document.getElementById("upload-link");
    const photoUpload = document.getElementById("upload-link-photo");
    const smartPhotoUpload = document.getElementById("smart-upload-link-photo");
    const smartUpload = document.getElementById("smart-upload-link");
    const openMenu = document.getElementById("open-menu");

    if (isMobile) {
        openMenu.style.display = "none";
        smartUpload.style.display = "grid";
        smartPhotoUpload.style.display = "grid";
        if (auth.currentUser) {
            upload.style.display = "none";
            photoUpload.style.display = "none";
        }
    } else {
        openMenu.style.display = "flex";
        smartUpload.style.display = "none";
        smartPhotoUpload.style.display = "none";
        if (auth.currentUser) {
            upload.style.display = "flex";
            photoUpload.style.display = "flex";
        }
    }
}

window.addEventListener('load', toggleUploadVisibility);
window.addEventListener('resize', toggleUploadVisibility);

// –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É
function updateUI(user) {
  if (user) {
    currentUserEmail = user.email;

    // –Ü–Ω—Ñ–æ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    const userInfoEl = document.getElementById("user-info");
    if (userInfoEl) userInfoEl.textContent = `–í–∏ —É–≤—ñ–π—à–ª–∏ —è–∫: ${user.email}`;

    // –ö–Ω–æ–ø–∫–∏/–ø–æ—Å–∏–ª–∞–Ω–Ω—è
    document.getElementById("signup")?.style?.setProperty("display", "none");
    document.getElementById("auth-link")?.style?.setProperty("display", "none");
    document.getElementById("register-link")?.style?.setProperty("display", "none");
    document.getElementById("logout-link")?.style?.setProperty("display", "flex");
    document.getElementById("account-link")?.style?.setProperty("display", "grid");
    document.getElementById("upload-link")?.style?.setProperty("display", "flex");
    document.getElementById("upload-link-photo")?.style?.setProperty("display", "flex");
    document.getElementById("smart-upload-link")?.style?.setProperty("display", "grid");
    document.getElementById("smart-upload-link-photo")?.style?.setProperty("display", "grid");

    // –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–ª—è –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ–≤ –¥–ª—è –≤—Å—ñ—Ö –≤—ñ–¥–µ–æ
    document.querySelectorAll('[id^="comment-input-"]').forEach(el => {
      el.style.display = "flex";
    });

    // –î–æ—Å—Ç—É–ø —Ç—ñ–ª—å–∫–∏ –¥–ª—è –ø–µ–≤–Ω–æ–≥–æ –¥–æ–º–µ–Ω—É
    const domainRestrictContainer = document.getElementById("domain-restrict-container");
    if (domainRestrictContainer) {
      if (currentUserEmail.endsWith("@kfccte-nau.ukr.education")) {
        domainRestrictContainer.style.display = "block";
      } else {
        domainRestrictContainer.style.display = "none";
      }
    }

  } else {
    currentUserEmail = null;

    // –Ü–Ω—Ñ–æ –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    const userInfoEl = document.getElementById("user-info");
    if (userInfoEl) userInfoEl.textContent = "";

    // –ö–Ω–æ–ø–∫–∏/–ø–æ—Å–∏–ª–∞–Ω–Ω—è
    document.getElementById("signup")?.style?.setProperty("display", "flex");
    document.getElementById("auth-link")?.style?.setProperty("display", "flex");
    document.getElementById("register-link")?.style?.setProperty("display", "flex");
    document.getElementById("logout-link")?.style?.setProperty("display", "none");
    document.getElementById("account-link")?.style?.setProperty("display", "none");
    document.getElementById("upload-link")?.style?.setProperty("display", "none");
    document.getElementById("upload-link-photo")?.style?.setProperty("display", "none");
    document.getElementById("smart-upload-link")?.style?.setProperty("display", "none");
    document.getElementById("smart-upload-link-photo")?.style?.setProperty("display", "none");

    // –°—Ö–æ–≤–∞—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ
    document.querySelectorAll('[id^="comment-input-"]').forEach(el => {
      el.style.display = "none";
    });
  }
}
async function backfillAuthorUidForUser() {
  const user = firebase.auth().currentUser;
  if (!user) return;

  const uid = user.uid;
  const email = user.email;

  const paths = ["videos", "photos", "comments"];

  for (const path of paths) {
    const snap = await database.ref(path).once("value");

    const updates = [];

    snap.forEach(child => {
      const data = child.val();

      // –ó–Ω–∞—Ö–æ–¥–∏–º–æ –¢–Ü–õ–¨–ö–ò –∫–æ–Ω—Ç–µ–Ω—Ç —Ü—å–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
      if (data.email === email) {
        // –Ø–∫—â–æ —â–µ –Ω–µ–º–∞ authorUid ‚Äî –¥–æ–¥–∞—î–º–æ
        if (!data.authorUid) {
          updates.push(
            database.ref(`${path}/${child.key}`).update({
              authorUid: uid
            })
          );
        }
      }
    });

    if (updates.length > 0) {
      await Promise.all(updates);
      console.log(`–û–Ω–æ–≤–ª–µ–Ω–æ ${updates.length} –∑–∞–ø–∏—Å—ñ–≤ —É ${path}`);
    }
  }
}
// –°–ª—É—Ö–∞—á —Å—Ç–∞–Ω—É –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó

const avatarEl = document.querySelector(".avatar");
const navAvatar = document.getElementById("nav-avatar");
const input = document.getElementById("avatar-input");
const btn = document.getElementById("change-avatar");

btn.onclick = () => input.click();

auth.onAuthStateChanged(async (user) => {
    if (!user) return;
loadPhotoChannelSelect();
loadChannelSelect();
backfillAuthorUidForUser();
    enablePushNotifications(user.uid);
    currentUserEmail = user.email;

    // üîπ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è email
    if (!user.emailVerified) {
        blockScreenForVerification();
        const verificationInterval = setInterval(() => {
            user.reload().then(() => {
                if (user.emailVerified) {
                    clearInterval(verificationInterval);
                    updateUI(user);
                }
            }).catch(err => console.error("–ü–æ–º–∏–ª–∫–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ email:", err));
        }, 10000);
    }

    // üîπ –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    const uid = user.uid;
    database.ref("users/" + uid).once("value").then(async snapshot => {
        const userData = snapshot.val();
        const birthStr = userData?.birthdate;
        const role = userData?.role || "user";
  const today = new Date();
      const m = today.getMonth() + 1;
      const d = today.getDate();


  // –í–∏–º–∫–Ω–µ–Ω–Ω—è Halloween 1 –ª–∏—Å—Ç–æ–ø–∞–¥–∞
      // üéÉ Halloween
const isHalloween = m === 10 && (d === 30 || d === 31);
const isValentineDay = m === 2 && (d === 13 || d === 14);
const isNewYear = (m === 12 && d >= 15) || (m === 1 && d <= 25);

// üéÉ HALLOWEEN
if (isHalloween) {
  activateHalloweenMode();
  applyIcons(halloweenIcons, userData);
} else {
  deactivateHalloweenMode();
}

// üéÑ NEW YEAR
if (isNewYear) {
  activateGirland();
  activateNewYearMode();
  applyIcons(newyearIcons, userData);
} else {
  deactivateGirland();
  deactivateNewYearMode();
  // –í—ñ–¥–Ω–æ–≤–ª—é—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ —ñ–∫–æ–Ω–∫–∏ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –Ω–µ Valentine
  if (!isValentineDay) restoreIcons();
}

// üíñ VALENTINE
if (isValentineDay) {
  applyIcons(valentineIcons, userData);
}
        // üîπ –Ø–∫—â–æ –Ω–µ–º–∞—î email –∞–±–æ –¥–∞—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è ‚Äî –ø–æ–∫–∞–∑–∞—Ç–∏ –º–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ
        if (!userData?.email || !birthStr) {
            const modal = document.getElementById("birthdate-modal");
            if (modal) modal.style.display = "flex";
        }

        // üîπ –û–±—á–∏—Å–ª–µ–Ω–Ω—è –≤—ñ–∫—É
        if (birthStr) {
            let birthDate;
            const match = birthStr.match(/^(\d{2})\.(\d{2})\.(\d{4})$/);
            if (match) {
                const [, d, m, y] = match;
                birthDate = new Date(`${y}-${m}-${d}`);
            } else {
                birthDate = new Date(birthStr);
            }

            if (!isNaN(birthDate)) {
                const today = new Date();
                let age = today.getFullYear() - birthDate.getFullYear();
                const mm = today.getMonth() - birthDate.getMonth();
                if (mm < 0 || (mm === 0 && today.getDate() < birthDate.getDate())) age--;
                userAge = age;
            }
        }

        // üîπ –û–Ω–æ–≤–ª–µ–Ω–Ω—è UI
        const viewBirthdate = document.getElementById("view");
        if (viewBirthdate) viewBirthdate.innerHTML = `–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è: ${birthStr || "–Ω–µ –≤–∫–∞–∑–∞–Ω–æ"}`;
        const emailEl = document.getElementById("email");
        if (emailEl) emailEl.innerHTML = `${userData?.name || ""} ${userData?.supername || ""}`;
        document.getElementById("name").innerHTML = `–Ü–º'—è: ${userData?.name || ""}`;
        document.getElementById("supername").innerHTML = `–ü—Ä—ñ–∑–≤–∏—â–µ: ${userData?.supername || ""}`;

        // üîπ –ê–≤–∞—Ç–∞—Ä
        if (userData?.avatarId) {
            try {
                const url = await firebase.storage().ref(`avatars/${userData.avatarId}.webp`).getDownloadURL();
                avatarEl.innerHTML = "";
                navAvatar.innerHTML = "";
                const img = document.createElement("img");
                img.src = url;
                img.alt = "–ê–≤–∞—Ç–∞—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞";
                avatarEl.appendChild(img);
                navAvatar.prepend(img.cloneNode(true));
            } catch {
                avatarEl.innerText = userData?.name ? userData.name.charAt(0).toUpperCase() : "?";
                navAvatar.innerText = userData?.name ? userData.name.charAt(0).toUpperCase() : "?";
            }
        } else {
            avatarEl.innerText = userData?.name ? userData.name.charAt(0).toUpperCase() : "?";
            navAvatar.innerText = userData?.name ? userData.name.charAt(0).toUpperCase() : "?";
        }

        // üîπ –û–±—Ä–æ–±–∫–∞ NSFW —Ñ—ñ–ª—å—Ç—Ä—É
        const nsfwCheckbox = document.getElementById('show-nsfw-videos');
        const nsfwSlider = document.getElementById("slidernsfw");
        const nsfwInfo = document.getElementById("information-nsfw");
        const NSFW = document.getElementById("nsfw");
        const privateVideo = document.getElementById("private-checkbox");
        const privatePhoto = document.getElementById("private-checkbox");
        if (nsfwCheckbox) {
            if (userAge < 13) {
                privateVideo.checked = true;
                if (nsfwSlider) nsfwSlider.style.backgroundColor = "gray";
                nsfwCheckbox.checked = false;
                nsfwCheckbox.disabled = true;
                if (NSFW) NSFW.style.display = "none";
                if (nsfwInfo) nsfwInfo.style.display = "block";
            } else if (userAge < 18) {
              if (nsfwSlider) nsfwSlider.style.backgroundColor = "gray";
                nsfwCheckbox.checked = false;
                nsfwCheckbox.disabled = true;
                if (NSFW) NSFW.style.display = "none";
                if (nsfwInfo) nsfwInfo.style.display = "block";
            } else {
                nsfwCheckbox.disabled = false;
                if (NSFW) NSFW.style.display = "block";
                if (nsfwInfo) nsfwInfo.style.display = "none";

                if (!nsfwCheckbox.dataset.listenerAdded) {
                    nsfwCheckbox.addEventListener("change", function () {
                        showNSFW = this.checked;
                        loadVideos();
                    });
                    nsfwCheckbox.dataset.listenerAdded = "true";
                }
            }
        }

        // üîπ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—ñ–¥–µ–æ –∑ —Ñ—ñ–ª—å—Ç—Ä–æ–º –∑–∞ —Å—Ç–∞—Ç—Ç—é
        loadVideos();
        enableBanduraUI(role);
    }).catch(err => console.error("–ü–æ–º–∏–ª–∫–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:", err));

    updateUI(user);
    toggleUploadVisibility();
});

// üîπ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∞–≤–∞—Ç–∞—Ä–∞
input.onchange = async () => {
    const file = input.files[0];
    if (!file) return;

    let uploadFile = file;

    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ HEIC
    if (file.type === "image/heic" || file.name.endsWith(".heic")) {
        try {
            const blob = await heic2any({ blob: file, toType: "image/webp" });
            uploadFile = new File([blob], file.name.replace(/\.heic$/i, ".webp"), { type: "image/webp" });
        } catch (err) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—ó HEIC:", err);
            return alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –∫–æ–Ω–≤–µ—Ä—Ç—É–≤–∞—Ç–∏ HEIC");
        }
    }

    // –î–∞–ª—ñ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —è–∫ —Ä–∞–Ω—ñ—à–µ
    const user = firebase.auth().currentUser;
    if (!user) return alert("–ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π");

    try {
        const avatarId = `${user.uid}_${Date.now()}`;
        const ref = firebase.storage().ref(`avatars/${avatarId}.webp`);
        await ref.put(uploadFile);

        await database.ref("users/" + user.uid).update({ avatarId });

        const url = await ref.getDownloadURL();
        avatarEl.innerHTML = "";
        navAvatar.innerHTML = "";
        const img = document.createElement("img");
        img.src = url;
        img.alt = "–ê–≤–∞—Ç–∞—Ä –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞";
        avatarEl.appendChild(img);
        navAvatar.prepend(img.cloneNode(true));
    } catch (err) {
        console.error(err);
        alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∞–≤–∞—Ç–∞—Ä");
    }
};
updateVideosAuthor();
function submitBirthdate() {
  const user = firebase.auth().currentUser;
  const input = document.getElementById("birthdate-input").value;
  const nameInput = document.getElementById("name-input").value;
  const supernameInput = document.getElementById("supername-input").value;


  if (!input || !nameInput || !supernameInput) {
    alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –≤–≤–µ–¥—ñ—Ç—å –¥–∞—Ç—É –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è.");
    return;
  }

  const [year, month, day] = input.split("-");
  const formattedDate = `${day}.${month}.${year}`;

  firebase.database().ref("users/" + user.uid).update({
    birthdate: formattedDate,
    email: user.email,
    name: nameInput,
    supername: supernameInput
  }).then(() => {
    alert("–î–∞—Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–∞.");
   updateVideosAuthor();
  });
}
function updateVideosAuthor() {
  const user = firebase.auth().currentUser;
  if (!user) return;

  const uid = user.uid;

  database.ref("users/" + uid).once("value").then(snapshot => {
    const userData = snapshot.val() || {};

    const fullName = `${userData.name || ""} ${userData.supername || ""}`.trim();
    const avatarUrl = userData.avatarUrl || "";

    const videoUpdates = [];

    return database.ref("videos").once("value").then(videoSnap => {
      videoSnap.forEach(child => {
        const video = child.val();
        if (video.email === user.email) {
          videoUpdates.push(
            database.ref("videos/" + child.key).update({
              author: fullName || "–ê–Ω–æ–Ω—ñ–º",
              authorAvatar: avatarUrl
            })
          );
        }
      });
      return Promise.all(videoUpdates);
    });
  }).then(() => {
    console.log("–í—ñ–¥–µ–æ –æ–Ω–æ–≤–ª–µ–Ω–æ");
    location.reload();
  }).catch(err => {
    console.error("–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:", err);
  });
}
document.getElementById("logout-link").onclick = function() {
            auth.signOut().then(() => {
                alert("–í–∏ –≤–∏–π—à–ª–∏ –∑ –∞–∫–∞—É–Ω—Ç—É.");
                location.reload();
            });
        };
function loadPhotos() {
    const photoGallery = document.getElementById("photo-gallery");
    if (!photoGallery) return;
    photoGallery.innerHTML = "";

    // üîπ –°–ª—É—Ö–∞—î–º–æ –Ω–æ–≤—ñ —Ñ–æ—Ç–æ —É —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
    database.ref("photos").on("child_added", snapshot => {
        const photoData = snapshot.val();
        const photoKey = snapshot.key;

        // üîπ –§–æ—Ç–æ –µ–ª–µ–º–µ–Ω—Ç
        const photoElement = document.createElement("img");
        photoElement.src = photoData.url;
        photoElement.alt = photoData.title || "–§–æ—Ç–æ";
        photoElement.classList.add("photo-item");

        // üîπ –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤ –ø—Ä–∏ –∫–ª—ñ–∫—É
        photoElement.addEventListener("click", () => {
            const newViewCount = (photoData.views || 0) + 1;
            database.ref("photos/" + photoKey).update({ views: newViewCount })
                .catch(error => console.error("–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–µ—Ä–µ–≥–ª—è–¥—ñ–≤:", error));
        });

        // üîπ –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ñ–æ—Ç–æ
        const infophotoElement = document.createElement("div");
        infophotoElement.classList.add("photo-info");

        // –ê–≤–∞—Ç–∞—Ä –∞–≤—Ç–æ—Ä–∞
        const avatar = document.createElement("div");
        avatar.classList.add("avatar");
        avatar.title = photoData.author || "–ê–Ω–æ–Ω—ñ–º";

        if (photoData.authorAvatar) {
            // –û—Ç—Ä–∏–º—É—î–º–æ URL –∞–≤–∞—Ç–∞—Ä–∞ –∑ Firebase Storage
            firebase.storage().ref(`avatars/${photoData.authorAvatar}.webp`).getDownloadURL()
                .then(url => {
                    avatar.style.backgroundImage = `url(${url})`;
                    avatar.classList.add("avatar-image");
                });
        } else {
            avatar.innerText = photoData.author ? photoData.author.charAt(0).toUpperCase() : "?";
            avatar.style.backgroundColor = stringToColor(photoData.author || "?");
        }

        const detailsphotoElement = document.createElement("div");
        detailsphotoElement.classList.add("photo-details");
        const safephotoTitle = sanitizeHTML(photoData.title || "–ë–µ–∑ –Ω–∞–∑–≤–∏");
        const safephotoAuthor = sanitizeHTML(photoData.author || "–ê–Ω–æ–Ω—ñ–º");
        const safephotoDescription = sanitizeHTML(photoData.description || "–ë–µ–∑ –æ–ø–∏—Å—É");
        detailsphotoElement.innerHTML = `
            <strong>${safephotoTitle}</strong><br>
            –ê–≤—Ç–æ—Ä: ${safephotoAuthor}<br>
            –î–∞—Ç–∞ –ø—É–±–ª—ñ–∫–∞—Ü—ñ—ó: ${photoData.publishDate || "–ù–µ –≤–∫–∞–∑–∞–Ω–∞"}<br>
            –û–ø–∏—Å: ${safephotoDescription}
        `;

        // üîπ –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –¥–ª—è –≤–ª–∞—Å–Ω–∏–∫–∞
        if (currentUserEmail === photoData.email || currentUserEmail === "zhuzhun2008@gmail.com") {
            const deletePhotoButton = document.createElement("button");
            deletePhotoButton.innerText = "–í–∏–¥–∞–ª–∏—Ç–∏";
            deletePhotoButton.style.backgroundColor = "red";
            deletePhotoButton.style.color = "white";
            deletePhotoButton.style.marginTop = "10px";
            deletePhotoButton.onclick = () => deletePhoto(photoKey, photoData.url);
            infophotoElement.appendChild(deletePhotoButton);
        }

        infophotoElement.appendChild(avatar);
        infophotoElement.appendChild(detailsphotoElement);

        // üîπ –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ñ–æ—Ç–æ
        const Photocontainer = document.createElement("div");
        Photocontainer.classList.add("photo-container");
        Photocontainer.appendChild(photoElement);
        Photocontainer.appendChild(infophotoElement);

        photoGallery.appendChild(Photocontainer);
    });
}

function deletePhoto(photoKey, photoURL) {
    if (confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü–µ —Ñ–æ—Ç–æ?")) {
        // –í–∏–¥–∞–ª–µ–Ω–Ω—è —Ñ–∞–π–ª—É –∑—ñ —Å—Ö–æ–≤–∏—â–∞
        const storageRef = storage.refFromURL(photoURL);
        storageRef.delete().then(() => {
            // –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
            database.ref(`photos/${photoKey}`).remove().then(() => {
                alert("–§–æ—Ç–æ —É—Å–ø—ñ—à–Ω–æ –≤–∏–¥–∞–ª–µ–Ω–æ.");
                loadPhotos(); // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ –≤—ñ–¥–µ–æ
            }).catch((error) => {
                alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ —Ñ–æ—Ç–æ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö: " + error.message);
            });
        }).catch((error) => {
            alert("–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ —Ñ–æ—Ç–æ –∑—ñ —Å—Ö–æ–≤–∏—â–∞: " + error.message);
        });
    }
}
function loadPhotoChannelSelect() {
    const select = document.getElementById("photo-channel-select");
    if (!select) return;

    const user = firebase.auth().currentUser;
    if (!user) return;

    const uid = user.uid;
    select.innerHTML = "";

    database.ref(`users/${uid}`).once("value").then(snapshot => {
        const userData = snapshot.val();
        if (!userData) return;

        // üîπ –û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª
        const mainName = `${userData.name || ""} ${userData.supername || ""}`.trim();

        const mainOption = document.createElement("option");
        mainOption.value = "main";
        mainOption.textContent = mainName || "–û—Å–Ω–æ–≤–Ω–∏–π –∫–∞–Ω–∞–ª";
        mainOption.dataset.name = mainName;
        mainOption.dataset.avatar = userData.avatar || "";
        select.appendChild(mainOption);

        // üîπ –î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª
        if (userData.channels && userData.channels.second) {
            const second = userData.channels.second;

            const secondOption = document.createElement("option");
            secondOption.value = "second";
            secondOption.textContent = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.name = second.name || "–î—Ä—É–≥–∏–π –∫–∞–Ω–∞–ª";
            secondOption.dataset.avatar = second.avatar || "";
            select.appendChild(secondOption);
        }
    });
}
    // Example of how video data might be stored with an 'nsfw' attribute
function uploadPhoto() {
    const user = firebase.auth().currentUser;
    if (!user) return alert("–£–≤—ñ–π–¥—ñ—Ç—å –≤ –∞–∫–∞—É–Ω—Ç");

    const channel = getActiveChannelData();
    if (!channel) return alert("–ù–µ –≤–∏–±—Ä–∞–Ω–æ –∫–∞–Ω–∞–ª");

    const photoDescription = document.getElementById("photo-description")?.value || "";
    const photoTitle = document.getElementById("photo-title")?.value || "";
    const photoFile = document.getElementById("photo-file")?.files[0];

    const uploadProgress = document.getElementById("upload-photo-progress");
    const progressText = document.getElementById("progressicon-photo-text");
    const progressContainer = document.getElementById("progress-photo-container");

    if (!photoTitle || !photoFile) {
        alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è!");
        return;
    }

    const storageRef = storage.ref(`photos/${Date.now()}_${photoFile.name}`);
    const uploadTask = storageRef.put(photoFile);

    uploadTask.on("state_changed",
        (snapshot) => {
            if (uploadProgress) {
                const progress = snapshot.bytesTransferred / snapshot.totalBytes * 100;
                uploadProgress.value = progress;
                if (progressText) progressText.innerText = `${Math.round(progress)}%`;
                if (progressContainer) progressContainer.style.display = "block";
            }
        },
        (error) => {
            alert("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ñ–æ—Ç–æ: " + error.message);
        },
        () => {
            uploadTask.snapshot.ref.getDownloadURL().then((downloadURL) => {
                const currentDate = new Date().toLocaleDateString();

                database.ref("photos").push({
                    title: photoTitle,
                    description: photoDescription,
                    url: downloadURL,
                    author: channel.name,
                    authorAvatar: channel.avatar,
                    channelKey: channel.key,
                    email: user.email,
                    publishDate: currentDate
                }).then(() => {
                    alert("–§–æ—Ç–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ!");
                    loadPhotos();
                    document.getElementById("upload-photo-form")?.reset();
                    if (progressContainer) progressContainer.style.display = "none";
                });
            });
        }
    );
}
// –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
function loadSettings() {
    const savedMaxTime = localStorage.getItem('maxTimeInMinutes');
    maxTimeInMinutes = savedMaxTime ? parseInt(savedMaxTime) : null;
    const maxInput = document.getElementById('maxTimeInput');
    if (maxInput) maxInput.value = maxTimeInMinutes ?? '';

    const savedSleepStart = localStorage.getItem('sleepStart');
    sleepStart = savedSleepStart !== '' ? savedSleepStart : null;
    const sleepStartInput = document.getElementById('sleepStart');
    if (sleepStartInput) sleepStartInput.value = sleepStart ?? '';

    const savedSleepEnd = localStorage.getItem('sleepEnd');
    sleepEnd = savedSleepEnd !== '' ? savedSleepEnd : null;
    const sleepEndInput = document.getElementById('sleepEnd');
    if (sleepEndInput) sleepEndInput.value = sleepEnd ?? '';

    const savedDate = localStorage.getItem('lastUsedDate');
    const currentDate = new Date().toDateString();

    if (savedDate !== currentDate) {
        localStorage.setItem('lastUsedDate', currentDate);
        timeLeftInSeconds = maxTimeInMinutes ? maxTimeInMinutes * 60 : null;
    } else {
        timeLeftInSeconds = parseInt(localStorage.getItem('timeLeft')) || (maxTimeInMinutes ? maxTimeInMinutes * 60 : null);
    }
}


// // –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è —á–∞—Å—É –¥–ª—è input type="time"
function formatTime(hour) {
    return hour !== null ? (hour < 10 ? '0' + hour + ':00' : hour + ':00') : '';
}

// –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
function saveSettings() {
    const maxTime = parseInt(document.getElementById('maxTimeInput').value);
    const sleepStartTime = document.getElementById('sleepStart').value;
    const sleepEndTime = document.getElementById('sleepEnd').value;

    maxTimeInMinutes = isNaN(maxTime) ? null : maxTime;
    sleepStart = sleepStartTime ? parseInt(sleepStartTime.split(':')[0]) : null;
    sleepEnd = sleepEndTime ? parseInt(sleepEndTime.split(':')[0]) : null;

    localStorage.setItem('maxTimeInMinutes', maxTimeInMinutes ?? '');
    localStorage.setItem('sleepStart', sleepStart ?? '');
    localStorage.setItem('sleepEnd', sleepEnd ?? '');

    if (timeLeftInSeconds === null) {
        timeLeftInSeconds = maxTimeInMinutes ? maxTimeInMinutes * 60 : null;
        if (timeLeftInSeconds !== null) {
            localStorage.setItem('timeLeft', timeLeftInSeconds);
        }
    }
}

// // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —á–∞—Å—É —Å–Ω—É
function isSleepTime() {
    if (!sleepStart || !sleepEnd) return false;

    const [startH, startM] = sleepStart.split(':').map(Number);
    const [endH, endM] = sleepEnd.split(':').map(Number);

    if (isNaN(startH) || isNaN(endH)) return false;

    const current = new Date();
    const nowMinutes = current.getHours() * 60 + current.getMinutes();
    const startMinutes = startH * 60 + startM;
    const endMinutes = endH * 60 + endM;

    return startMinutes < endMinutes
        ? nowMinutes >= startMinutes && nowMinutes < endMinutes
        : nowMinutes >= startMinutes || nowMinutes < endMinutes;
}



// // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞–π–º–µ—Ä–∞ —Ç–∞ —Ñ–æ–Ω—É
function updateTimer() {
    if (isSleepTime()) {
        document.body.style.background = "background: radial-gradient(circle at left top, rgb(15, 23, 42), rgb(10, 14, 26))";
        document.body.innerHTML = `<h1 style="color: white; text-align: center;">–ß–∞—Å —Å–ø–∞—Ç–∏. –°–∞–π—Ç —Ä–æ–∑–±–ª–æ–∫—É—î—Ç—å—Å—è –æ ${sleepEnd}:00</h1>`;
        return;
    } else {
        document.body.style.background = "background: radial-gradient(circle at left top, rgb(15, 23, 42), rgb(10, 14, 26))";
    }

    if (timeLeftInSeconds !== null && timeLeftInSeconds > 0) {
        const minutes = Math.floor(timeLeftInSeconds / 60);
        const seconds = timeLeftInSeconds % 60;
        document.getElementById('timer').textContent = `–ó–∞–ª–∏—à–∏–ª–æ—Å—å —á–∞—Å—É: ${minutes} —Ö–≤ ${seconds} —Å–µ–∫`;
        timeLeftInSeconds--;
        localStorage.setItem('timeLeft', timeLeftInSeconds);
    } else if (timeLeftInSeconds !== null) {
        document.body.style.background = "mediumseagreen";
        document.body.innerHTML = `<h1 style="color: white; text-align: center;">–ß–∞—Å –∑–∞–∫—ñ–Ω—á–∏–≤—Å—è. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–π—Ç–∏ —ñ–∑ —Å–∞–π—Ç—É —â–æ–± –Ω–µ –ø–µ—Ä–µ–≤–∏—â—É–≤–∞—Ç–∏ –µ–∫—Ä–∞–Ω–Ω–∏–π –ª—ñ–º—ñ—Ç.</h1>`;
        return;
    }

    // –°–∫–∏–¥–∞–Ω–Ω—è —Ç–∞–π–º–µ—Ä–∞ –ø—ñ—Å–ª—è 00:00
    const currentDate = new Date().toDateString();
    if (localStorage.getItem('lastUsedDate') !== currentDate) {
        localStorage.setItem('lastUsedDate', currentDate);
        timeLeftInSeconds = maxTimeInMinutes ? maxTimeInMinutes * 60 : null;
        localStorage.setItem('timeLeft', timeLeftInSeconds);
    }
}

// –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞
setInterval(updateTimer, 1000);




        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

window.onload = function() {
        loadSettings();
        loadVideos();
        loadPhotos();
        const commentsContainer = document.getElementById('comments');
  if (commentsContainer) {
    loadComments();
  }
    };
    </script>
    <!-- üî∞ –†–ï–ñ–ò–ú –î–õ–Ø –õ–Æ–î–ï–ô –Ü–ó –ó–ú–† -->
<script>
// === –ù–∞–¥—ñ–π–Ω–∞ –∑–∞–º—ñ–Ω–∞ —Ç–µ–∫—Å—Ç—ñ–≤ (–≤—É–∑–ª–∏ + –∞—Ç—Ä–∏–±—É—Ç–∏) –¥–ª—è –ó–ú–†-—Ä–µ–∂–∏–º—É ===
document.addEventListener("DOMContentLoaded", () => {
  // üîò –î–æ–¥–∞—î–º–æ –ø–µ—Ä–µ–º–∏–∫–∞—á —É –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∞–∫–∞—É–Ω—Ç–∞
  const accountForm = document.getElementById("account-form");
  if (accountForm && !document.getElementById("zmr-mode-toggle")) {
    const zmrToggleContainer = document.createElement("div");
    zmrToggleContainer.innerHTML = `
      <label style="display:flex;align-items:center;gap:10px;margin-top:15px;">
        <span>–†–µ–∂–∏–º –¥–ª—è –ª—é–¥–µ–π —ñ–∑ –ó–ú–†</span>
        <label class="switch">
          <input type="checkbox" id="zmr-mode-toggle">
          <span class="slider round"></span>
        </label>
      </label>`;
    accountForm.appendChild(zmrToggleContainer);
  }

  const toggle = document.getElementById("zmr-mode-toggle");
  if (!toggle) return;

  // –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ —Å—Ç–∞–Ω—É
  const saved = localStorage.getItem("zmrMode") === "true";
  toggle.checked = saved;
  applyZMRMode(saved);

  toggle.addEventListener("change", function() {
    const enabled = this.checked;
    localStorage.setItem("zmrMode", enabled);
    applyZMRMode(enabled);
  });
});
// –Ø–∫—â–æ –≤–∂–µ —î —Å–ª–æ–≤–Ω–∏–∫, –º–æ–∂–Ω–∞ –π–æ–≥–æ –æ–Ω–æ–≤–∏—Ç–∏ —Ç—É—Ç
const simpleTextMap = {
  "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—ñ–¥–µ–æ": "–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–µ–æ",
  "–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —Ñ–æ—Ç–æ": "–î–æ–¥–∞—Ç–∏ —Ñ–æ—Ç–æ",
  "–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –∞–∫–∞—É–Ω—Ç": "–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å",
  "–í–∏–¥–∞–ª–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç": "–í–∏–¥–∞–ª–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å",
  "–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ": "–ó–º—ñ–Ω–∏—Ç–∏ –≤—ñ–¥–µ–æ",
  "–ù–∞–∑–≤–∞ –≤—ñ–¥–µ–æ": "–ù–∞–∑–≤–∞",
  "–û–ø–∏—Å –≤—ñ–¥–µ–æ": "–û–ø–∏—Å",
  "–í–∏–π—Ç–∏": "–í–∏—Ö—ñ–¥",
  "–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è": "–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç",
  "–£–≤—ñ–π—Ç–∏": "–í—Ö—ñ–¥",
  "–î–æ–ø–∏—Å–∏": "–§–æ—Ç–æ",
  "–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ –≤–∏–º–∫–Ω–µ–Ω—ñ –¥–ª—è —Ü—å–æ–≥–æ –≤—ñ–¥–µ–æ": "–í—ñ–¥–≥—É–∫–∏ –≤–∏–º–∫–Ω–µ–Ω–æ",
  "–í–∏–º–∫–Ω—É—Ç–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ": "–í–∏–º–∫–Ω—É—Ç–∏ –≤—ñ–¥–≥—É–∫–∏",
  "–í–∏–¥–∞–ª–µ–Ω–∏–π –∞–∫–∞—É–Ω—Ç": "–í–∏–¥–∞–ª–µ–Ω–∏–π –ø—Ä–æ—Ñ—ñ–ª—å",
  "–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è": "–î–µ–Ω—å –Ω–∞—Ä.",
  "–ó–±–µ—Ä–µ–≥—Ç–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è": "–û–ö",
  "–ó–±–µ—Ä–µ–≥—Ç–∏": "OK",
  "–ó—Ä–æ–∑—É–º—ñ–ª–æ": "–î–æ–±—Ä–µ",
  "–ü–æ–∫–∞–∑—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ –ø–æ–∑–Ω–∞—á–µ–Ω–Ω—ñ —è–∫ NSFW": "–î–æ—Ä–æ—Å–ª—ñ –≤—ñ–¥–µ–æ",
  "–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±–º–µ–∂–µ–Ω–Ω—è –µ–∫—Ä–∞–Ω–Ω–æ–≥–æ —á–∞—Å—É": "–û–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É",
   "–ö–æ–º–µ–Ω—Ç–∞—Ä—ñ": "–í—ñ–¥–≥—É–∫–∏",
  "–í–∫–∞–∂—ñ—Ç—å, —Å–∫—ñ–ª—å–∫–∏ —Ö–≤–∏–ª–∏–Ω –Ω–∞ –¥–µ–Ω—å –≤–∏ —Ö–æ—á–µ—Ç–µ –±—É—Ç–∏ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ:": "–°–∫—ñ–ª—å–∫–∏ —Ö–≤–∏–ª–∏–Ω —Å–∏–¥—ñ—Ç–∏ —Ç—É—Ç:",
  "–í–∫–∞–∂—ñ—Ç—å —á–∞—Å —Å–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 21:00 - 07:00):": "–ö–æ–ª–∏ –ª—è–≥–∞—Ç–∏ —Å–ø–∞—Ç–∏:",
  "–ü—Ä–∏–≤–∞—Ç–Ω–µ –≤—ñ–¥–µ–æ": "–õ–∏—à–µ –¥–ª—è —Å–µ–±–µ",
  "–í–∞–º –ø–æ–≤–∏–Ω–Ω–æ –±—É—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 18 —Ä–æ–∫—ñ–≤, —â–æ–± –ø–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ NSFW –í—ñ–¥–µ–æ.": "–¶—è —Ñ—É–Ω–∫—Ü—ñ—è –ª–∏—à–µ –¥–ª—è –¥–æ—Ä–æ—Å–ª–∏—Ö.",
  "–ü–æ–∑–Ω–∞—á–∏—Ç–∏ –≤—ñ–¥–µ–æ —è–∫ NSFW": "–ü–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ –¥–æ—Ä–æ—Å–ª–µ"
};

// –ü—Ä–µ-–∫–æ–º–ø—ñ–ª—é—î–º–æ –º–∞—Å–∏–≤ –ø–∞—Ä RegExp —â–æ–± –±—É–ª–æ —à–≤–∏–¥—à–µ
const replacePairs = Object.entries(simpleTextMap).map(([from, to]) => {
  return { re: new RegExp(from.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), "gi"), to };
});

// --- –§—É–Ω–∫—Ü—ñ—è: –∑–∞–º—ñ–Ω–∞ —É —Ç–µ–∫—Å—Ç–æ–≤–æ–º—É –≤—É–∑–ª—ñ ---
function replaceInTextNode(textNode) {
  const original = textNode._origText ?? textNode.nodeValue;
  if (textNode._origText === undefined) textNode._origText = original;
  let newText = original;
  replacePairs.forEach(({re, to}) => {
    newText = newText.replace(re, to);
  });
  if (newText !== textNode.nodeValue) textNode.nodeValue = newText;
}

// --- –§—É–Ω–∫—Ü—ñ—è: –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –≤—É–∑–ª–∞ ---
function restoreTextNode(textNode) {
  if (textNode._origText !== undefined) {
    textNode.nodeValue = textNode._origText;
    delete textNode._origText;
  }
}

// --- –û–±—Ä–æ–±–∫–∞ –∞—Ç—Ä–∏–±—É—Ç—ñ–≤ –∫–ª—é—á–æ–≤–∏—Ö —Ç–∏–ø—ñ–≤ ---
const ATTRS = ['value','placeholder','title','aria-label','alt'];

function replaceAttributes(el) {
  ATTRS.forEach(attr => {
    if (!el.hasAttribute || !el.hasAttribute(attr)) return;
    const key = `_orig_attr_${attr}`;
    const cur = el.getAttribute(attr);
    if (el[key] === undefined) el[key] = cur; // –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –æ—Ä–∏–≥—ñ–Ω–∞–ª
    let newVal = el[key];
    replacePairs.forEach(({re, to}) => newVal = newVal.replace(re, to));
    if (newVal !== cur) el.setAttribute(attr, newVal);
  });
}

function restoreAttributes(el) {
  ATTRS.forEach(attr => {
    const key = `_orig_attr_${attr}`;
    if (el[key] !== undefined) {
      el.setAttribute(attr, el[key]);
      delete el[key];
    }
  });
}

// --- –ü—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è –ø–æ –≤—Å—ñ—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏–º –≤—É–∑–ª–∞–º –≤ –µ–ª–µ–º–µ–Ω—Ç—ñ ---
function processTextNodes(root, fn) {
  const walker = document.createTreeWalker(root, NodeFilter.SHOW_TEXT, {
    acceptNode: node => {
      // –ø—Ä–æ–ø—É—Å–∫–∞—î–º–æ —Ç–µ–∫—Å—Ç —É <script> —Ç–∞ <style>
      const parent = node.parentElement;
      if (!parent) return NodeFilter.FILTER_REJECT;
      const tag = parent.tagName && parent.tagName.toLowerCase();
      if (tag === 'script' || tag === 'style' || tag === 'textarea') return NodeFilter.FILTER_REJECT;
      // –Ω–µ —á—ñ–ø–∞—î–º–æ —á–∏—Å—Ç–æ –ø—Ä–æ–±—ñ–ª–∏
      if (!node.nodeValue || !node.nodeValue.trim()) return NodeFilter.FILTER_REJECT;
      return NodeFilter.FILTER_ACCEPT;
    }
  }, false);

  let node;
  while ((node = walker.nextNode())) {
    try { fn(node); } catch(e){ console.warn("replace text node error", e); }
  }
}

// --- –°–ø—Ä–æ—â–µ–Ω–Ω—è –≤—Å—ñ—î—ó —Å—Ç–æ—Ä—ñ–Ω–∫–∏ ---
function simplifyAllTextsAdvanced(root = document.body) {
  // —Ç–µ–∫—Å—Ç–æ–≤—ñ –≤—É–∑–ª–∏
  processTextNodes(root, replaceInTextNode);
  // –∞—Ç—Ä–∏–±—É—Ç–∏
  root.querySelectorAll('*').forEach(el => {
    try { replaceAttributes(el); } catch(e){ /* ignore */ }
  });
}

// --- –í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—Å—ñ—Ö –æ—Ä–∏–≥—ñ–Ω–∞–ª—ñ–≤ ---
function restoreAllOriginals(root = document.body) {
  processTextNodes(root, restoreTextNode);
  root.querySelectorAll('*').forEach(el => {
    try { restoreAttributes(el); } catch(e){ /* ignore */ }
  });
}

// --- MutationObserver –¥–ª—è –¥–∏–Ω–∞–º—ñ–∫–∏ ---
function observeDOMChangesAdvanced() {
  if (window.zmrAdvancedObserver) return;
  window.zmrAdvancedObserver = new MutationObserver(mutations => {
    // –¥–ª—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ: –æ–±—Ä–æ–±–ª—è—î–º–æ –ª–∏—à–µ –¥–æ–¥–∞–Ω—ñ/–∑–º—ñ–Ω–µ–Ω—ñ –≤—É–∑–ª–∏
    mutations.forEach(m => {
      if (m.addedNodes && m.addedNodes.length) {
        m.addedNodes.forEach(node => {
          if (node.nodeType === Node.ELEMENT_NODE) {
            simplifyAllTextsAdvanced(node);
          } else if (node.nodeType === Node.TEXT_NODE) {
            replaceInTextNode(node);
          }
        });
      }
      if (m.type === 'attributes' && m.target) {
        // —è–∫—â–æ –∞—Ç—Ä–∏–±—É—Ç –∑–º—ñ–Ω–∏–≤—Å—è ‚Äî —Å–ø—Ä–æ–±—É—î–º–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ –π–æ–≥–æ —Ç–µ–∂
        replaceAttributes(m.target);
      }
    });
  });

  window.zmrAdvancedObserver.observe(document.body, {
    childList: true,
    subtree: true,
    attributes: true,
    attributeFilter: ATTRS
  });
}

function disconnectObserverAdvanced() {
  if (window.zmrAdvancedObserver) {
    window.zmrAdvancedObserver.disconnect();
    window.zmrAdvancedObserver = null;
  }
}

// --- –ü—É–±–ª—ñ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–º–∏–∫/–≤–∏–º–∏–∫ ---
function enableZMRAdvanced() {
  simplifyAllTextsAdvanced(document.body);
  observeDOMChangesAdvanced();
  document.body.classList.add('zmr-mode');
}

function disableZMRAdvanced() {
  disconnectObserverAdvanced();
  restoreAllOriginals(document.body);
  document.body.classList.remove('zmr-mode');
}

// --- –Ø–∫—â–æ —É —Ç–µ–±–µ —î –ø–µ—Ä–µ–º–∏–∫–∞—á #zmr-mode-toggle, –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ –π–æ–≥–æ ---
document.addEventListener('DOMContentLoaded', () => {
  const t = document.getElementById('zmr-mode-toggle');
  if (!t) return;
  const saved = localStorage.getItem('zmrMode') === 'true';
  t.checked = saved;
  if (saved) enableZMRAdvanced();

  t.addEventListener('change', () => {
    const on = t.checked;
    localStorage.setItem('zmrMode', on);
    if (on) enableZMRAdvanced(); else disableZMRAdvanced();
  });
});
</script>
</body>                                                          
        </html>